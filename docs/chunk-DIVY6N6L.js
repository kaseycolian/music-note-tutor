import{$a as ee,Ba as V,Ca as we,Ga as Oe,Ha as M,Ia as v,Ja as x,Ka as Ne,L as O,La as L,Ma as B,Na as $,Oa as c,P as h,Pa as a,Qa as Ee,Ra as D,S as me,Sa as S,Ta as J,U as P,Ua as k,V as w,Va as y,W as G,Wa as Ae,X,Xa as f,Y as he,Ya as q,Za as Q,_a as Z,a as E,ab as W,b as A,ba as p,bb as s,c as ae,cb as N,da as _e,db as F,eb as ke,fa as be,ib as _,ja as Ce,jb as te,kb as De,lb as H,ma as ve,na as ce,oa as l,ob as le,pb as Se,ta as xe,ua as Me,ub as K,wa as ye,xa as Pe,yb as Te}from"./chunk-JG4IYQLX.js";function Fe(){let o=typeof document<"u"&&document?document.activeElement:null;for(;o&&o.shadowRoot;){let t=o.shadowRoot.activeElement;if(t===o)break;o=t}return o}var de;try{de=typeof Intl<"u"&&Intl.v8BreakIterator}catch{de=!1}var ue=(()=>{class o{_platformId=h(Ce);isBrowser=this._platformId?Te(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||de)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var ne=new WeakMap,Ie=(()=>{class o{_appRef;_injector=h(X);_environmentInjector=h(me);load(e){let n=this._appRef=this._appRef||this._injector.get(Oe),i=ne.get(n);i||(i={loaders:new Set,refs:[]},ne.set(n,i),n.onDestroy(()=>{ne.get(n)?.refs.forEach(r=>r.destroy()),ne.delete(n)})),i.loaders.has(e)||(i.loaders.add(e),i.refs.push(Se(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Re=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275cmp=V({type:o,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(n,i){},styles:[`.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}
`],encapsulation:2,changeDetection:0})}return o})();var Ue=(()=>{class o{_platform=h(ue);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return qe(e)&&getComputedStyle(e).visibility==="visible"}isTabbable(e){if(!this._platform.isBrowser)return!1;let n=Ye(ot(e));if(n&&(Le(n)===-1||!this.isVisible(n)))return!1;let i=e.nodeName.toLowerCase(),r=Le(e);return e.hasAttribute("contenteditable")?r!==-1:i==="iframe"||i==="object"||this._platform.WEBKIT&&this._platform.IOS&&!tt(e)?!1:i==="audio"?e.hasAttribute("controls")?r!==-1:!1:i==="video"?r===-1?!1:r!==null?!0:this._platform.FIREFOX||e.hasAttribute("controls"):e.tabIndex>=0}isFocusable(e,n){return nt(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(n){return new(n||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function Ye(o){try{return o.frameElement}catch{return null}}function qe(o){return!!(o.offsetWidth||o.offsetHeight||typeof o.getClientRects=="function"&&o.getClientRects().length)}function Qe(o){let t=o.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function Ze(o){return Je(o)&&o.type=="hidden"}function Xe(o){return et(o)&&o.hasAttribute("href")}function Je(o){return o.nodeName.toLowerCase()=="input"}function et(o){return o.nodeName.toLowerCase()=="a"}function Be(o){if(!o.hasAttribute("tabindex")||o.tabIndex===void 0)return!1;let t=o.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function Le(o){if(!Be(o))return null;let t=parseInt(o.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function tt(o){let t=o.nodeName.toLowerCase(),e=t==="input"&&o.type;return e==="text"||e==="password"||t==="select"||t==="textarea"}function nt(o){return Ze(o)?!1:Qe(o)||Xe(o)||o.hasAttribute("contenteditable")||Be(o)}function ot(o){return o.ownerDocument&&o.ownerDocument.defaultView||window}var fe=class{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_enabled=!0;constructor(t,e,n,i,r=!1,d){this._element=t,this._checker=e,this._ngZone=n,this._document=i,this._injector=d,r||this.attachAnchors()}destroy(){let t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){let n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){let e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=0;n<e.length;n++){let i=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(i)return i}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=e.length-1;n>=0;n--){let i=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(i)return i}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._injector?Me(t,{injector:this._injector}):setTimeout(t)}},He=(()=>{class o{_checker=h(Ue);_ngZone=h(xe);_document=h(he);_injector=h(X);constructor(){h(Ie).load(Re)}create(e,n=!1){return new fe(e,this._checker,this._ngZone,this._document,n,this._injector)}static \u0275fac=function(n){return new(n||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),ge=(()=>{class o{_elementRef=h(be);_focusTrapFactory=h(He);focusTrap;_previouslyFocusedElement=null;get enabled(){return this.focusTrap?.enabled||!1}set enabled(e){this.focusTrap&&(this.focusTrap.enabled=e)}autoCapture;constructor(){h(ue).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(e){let n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Fe(),this.focusTrap?.focusInitialElementWhenReady()}static \u0275fac=function(n){return new(n||o)};static \u0275dir=we({type:o,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",le],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",le]},exportAs:["cdkTrapFocus"],features:[_e]})}return o})();var R=["C","D","E","F","G","A","B"];var je=[{mode:"default",label:"Default",description:"All note positions for treble and bass clefs"},{mode:"easy",label:"Easy",description:"Only notes on the staff lines and spaces"},{mode:"hard",label:"Hard",description:"Only notes on ledger lines above and below staff"}],Ve=[{filter:"both",label:"Both",description:"Show notes from both treble and bass clefs"},{filter:"treble",label:"Treble",description:"Show only treble clef notes"},{filter:"bass",label:"Bass",description:"Show only bass clef notes"}],We=[{filter:"all",label:"All",description:"Practice all notes"},{filter:"C",label:"C",description:"Practice only C notes"},{filter:"D",label:"D",description:"Practice only D notes"},{filter:"E",label:"E",description:"Practice only E notes"},{filter:"F",label:"F",description:"Practice only F notes"},{filter:"G",label:"G",description:"Practice only G notes"},{filter:"A",label:"A",description:"Practice only A notes"},{filter:"B",label:"B",description:"Practice only B notes"}],pe={treble:{easy:["E4","F4","G4","A4","B4","C5","D5","E5","F5"],hard:["C4","D4","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7"],default:["C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7"]},bass:{easy:["G2","A2","B2","C3","D3","E3","F3","G3","A3"],hard:["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","B3","C4","D4","E4","F4","G4","A4","B4","C5"],default:["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5"]}};var oe=class o{levelConfigurations=new Map;constructor(){this.initializeLevelConfigurations()}getLevelConfiguration(t){let e=this.levelConfigurations.get(t);if(!e)throw new Error(`No configuration found for level: ${t}`);return e}getAvailableLevels(){return Array.from(this.levelConfigurations.keys())}getNextLevel(t){let e=["easy","hard","mixed"],n=e.indexOf(t);return n>=0&&n<e.length-1?e[n+1]:null}canUnlockLevel(t,e,n){let i=this.getLevelConfiguration(t);return e>=i.progressionCriteria.minAccuracy&&n>=i.progressionCriteria.minQuestions}getBaseWeights(t){let e=this.getLevelConfiguration(t);return new Map(e.baseWeights)}updateBaseWeights(t,e){let n=this.levelConfigurations.get(t);if(n){let i=A(E({},n),{baseWeights:new Map(e)});this.levelConfigurations.set(t,i)}}initializeLevelConfigurations(){this.levelConfigurations.set("easy",this.createEasyConfig()),this.levelConfigurations.set("hard",this.createHardConfig()),this.levelConfigurations.set("mixed",this.createMixedConfig())}createEasyConfig(){let t={trebleRange:{min:4,max:6},bassRange:{min:1,max:4},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!1},e={trebleWeight:.7,bassWeight:.3},n={minAccuracy:.78,minQuestions:35,consecutiveCorrect:7},i=this.generateBaseWeights(t,1);return{level:"easy",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}createHardConfig(){let t={trebleRange:{min:3,max:7},bassRange:{min:1,max:5},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!0},e={trebleWeight:.5,bassWeight:.5},n={minAccuracy:.88,minQuestions:150,consecutiveCorrect:12},i=this.generateBaseWeights(t,1);return{level:"hard",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}createMixedConfig(){let t={trebleRange:{min:3,max:7},bassRange:{min:1,max:5},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!0},e={trebleWeight:.5,bassWeight:.5},n={minAccuracy:.83,minQuestions:100,consecutiveCorrect:10},i=this.generateBaseWeights(t,1);return{level:"mixed",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}generateBaseWeights(t,e){let n=new Map;return["treble","bass"].forEach(r=>{let d=r==="treble"?t.trebleRange:t.bassRange;for(let g=d.min;g<=d.max;g++)t.allowedNotes.forEach(m=>{let u=`${m}${g}-${r}`;n.set(u,e),t.includeAccidentals&&(n.set(`${u}-sharp`,e*.8),n.set(`${u}-flat`,e*.8))})}),n}getNotePriorities(t){return{easy:{"C4-treble":1.4,"D4-treble":1.3,"E4-treble":1.3,"F4-treble":1.2,"G4-treble":1.2,"A4-treble":1.2,"B4-treble":1.2,"C5-treble":1.1,"C3-bass":1.3,"D3-bass":1.2,"E3-bass":1.2},hard:{"C6-treble":1.1,"C7-treble":1,"B2-bass":1.1,"C1-bass":1,"F4-treble-sharp":1,"B4-treble-flat":1,"F3-bass-sharp":1,"A5-treble-flat":1}}[t]||{}}getAdaptiveWeightingParams(t){return{easy:{performanceWeight:.45,recencyWeight:.28,difficultyWeight:.17,randomnessWeight:.1},hard:{performanceWeight:.65,recencyWeight:.18,difficultyWeight:.1,randomnessWeight:.07},mixed:{performanceWeight:.55,recencyWeight:.23,difficultyWeight:.13,randomnessWeight:.09}}[t]}static \u0275fac=function(e){return new(e||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};var U=class o{save(t,e){try{let n=JSON.stringify(e);localStorage.setItem(t,n)}catch(n){console.error(`Failed to save data to localStorage for key: ${t}`,n)}}load(t){try{let e=localStorage.getItem(t);return e===null?null:JSON.parse(e)}catch(e){return console.error(`Failed to load data from localStorage for key: ${t}`,e),null}}clear(t){try{localStorage.removeItem(t)}catch(e){console.error(`Failed to clear data from localStorage for key: ${t}`,e)}}exists(t){return localStorage.getItem(t)!==null}getKeysWithPrefix(t){let e=[];for(let n=0;n<localStorage.length;n++){let i=localStorage.key(n);i&&i.startsWith(t)&&e.push(i)}return e}clearAll(){try{localStorage.clear()}catch(t){console.error("Failed to clear all localStorage data",t)}}getStorageSize(){let t=0;for(let e in localStorage)localStorage.hasOwnProperty(e)&&(t+=localStorage[e].length+e.length);return t}static \u0275fac=function(e){return new(e||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};var Y=class o{storageService=h(U);userProgress=p(this.getDefaultProgress());currentSession=p(null);currentLevel=_(()=>this.userProgress().currentLevel);overallAccuracy=_(()=>this.userProgress().overallAccuracy);totalQuestions=_(()=>this.userProgress().totalQuestionsAnswered);sessionDuration=_(()=>{let t=this.currentSession();return!t||!t.endTime?0:t.endTime.getTime()-t.startTime.getTime()});constructor(){this.loadProgress(),this.startNewSession()}getCurrentProgress(){return this.userProgress()}updateLevel(t){let e=this.userProgress();if(e.levelProgression.find(i=>i.level===t)){let i=A(E({},e),{currentLevel:t});this.userProgress.set(i),this.saveProgress()}else{let i={level:t,unlockedAt:new Date,questionsAtLevel:0,accuracyAtLevel:0},r=A(E({},e),{currentLevel:t,levelProgression:[...e.levelProgression,i]});this.userProgress.set(r),this.saveProgress()}}recordQuestionAttempt(t,e){let n=this.userProgress(),i=this.currentSession(),r=n.totalQuestionsAnswered+1,g=Math.round(n.overallAccuracy*n.totalQuestionsAnswered)+(t?1:0),m=r>0?g/r:0,u=n.levelProgression.map(b=>{if(b.level===n.currentLevel){let T=b.questionsAtLevel+1,j=Math.round(b.accuracyAtLevel*b.questionsAtLevel)+(t?1:0),Ke=T>0?j/T:0;return A(E({},b),{questionsAtLevel:T,accuracyAtLevel:Ke})}return b}),C=A(E({},n),{totalQuestionsAnswered:r,overallAccuracy:m,levelProgression:u});if(this.userProgress.set(C),i){let b=A(E({},i),{questionsAnswered:i.questionsAnswered+1,correctAnswers:i.correctAnswers+(t?1:0),averageResponseTime:this.calculateNewAverageResponseTime(i.averageResponseTime,i.questionsAnswered,e)});this.currentSession.set(b),this.saveSession(b)}this.saveProgress()}startNewSession(){let e={sessionId:this.generateSessionId(),startTime:new Date,questionsAnswered:0,correctAnswers:0,averageResponseTime:0,notesEncountered:[]};this.currentSession.set(e),this.saveSession(e)}endCurrentSession(){let t=this.currentSession();if(t){let e=A(E({},t),{endTime:new Date});this.currentSession.set(e),this.saveSession(e)}}getSessionStats(){let t=this.currentSession();if(!t)return{questionsAnswered:0,accuracy:0,averageResponseTime:0,duration:0};let e=t.questionsAnswered>0?t.correctAnswers/t.questionsAnswered:0,n=t.endTime?t.endTime.getTime()-t.startTime.getTime():Date.now()-t.startTime.getTime();return{questionsAnswered:t.questionsAnswered,accuracy:e,averageResponseTime:t.averageResponseTime,duration:n}}resetProgress(){let t=this.getDefaultProgress();this.userProgress.set(t),this.currentSession.set(null),this.storageService.clear("user-progress"),this.storageService.clear("current-session"),this.startNewSession()}exportProgress(){return JSON.stringify({progress:this.userProgress(),session:this.currentSession()},null,2)}importProgress(t){try{let e=JSON.parse(t);return e.progress&&(this.userProgress.set(e.progress),this.saveProgress()),e.session&&(this.currentSession.set(e.session),this.saveSession(e.session)),!0}catch(e){return console.error("Failed to import progress data:",e),!1}}getDefaultProgress(){return{currentLevel:"easy",totalQuestionsAnswered:0,overallAccuracy:0,sessionStartTime:new Date,levelProgression:[{level:"easy",unlockedAt:new Date,questionsAtLevel:0,accuracyAtLevel:0}]}}calculateNewAverageResponseTime(t,e,n){return e===0?n:(t*e+n)/(e+1)}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}saveProgress(){this.storageService.save("user-progress",this.userProgress())}loadProgress(){let t=this.storageService.load("user-progress");if(t){let e=A(E({},t),{sessionStartTime:new Date(t.sessionStartTime),levelProgression:t.levelProgression.map(n=>A(E({},n),{unlockedAt:new Date(n.unlockedAt)}))});this.userProgress.set(e)}}saveSession(t){this.storageService.save("current-session",t)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};var ie=class o{performanceData=p(new Map);currentLevel=p("easy");recentHistory=p([]);difficultyMode=p("default");clefFilter=p("both");noteFilter=p("all");overallAccuracy=_(()=>{let t=Array.from(this.performanceData().values());if(t.length===0)return 0;let e=t.reduce((i,r)=>i+r.correctAnswers,0),n=t.reduce((i,r)=>i+r.attempts,0);return n>0?e/n:0});configService=h(oe);progressService=h(Y);storageService=h(U);constructor(){te(()=>{this.persistPerformanceData()}),this.loadPerformanceData()}generateNextNote(t){let e=this.buildSelectionContext(t),n=this.buildCandidatePool(e),i=this.calculateWeights(n,e),r=this.performWeightedSelection(i);return this.updateHistory(r),r}recordAnswer(t,e,n,i){this.updatePerformanceData(t,n,i),this.checkLevelProgression()}getCurrentLevelConfig(){return this.configService.getLevelConfiguration(this.currentLevel())}getPerformanceStats(){return new Map(this.performanceData())}resetProgress(){this.performanceData.set(new Map),this.recentHistory.set([]),this.currentLevel.set("easy"),this.storageService.clear("performance-data"),this.storageService.clear("recent-history"),this.storageService.clear("current-level")}setDifficultyMode(t){this.difficultyMode.set(t)}getDifficultyMode(){return this.difficultyMode()}setClefFilter(t){this.clefFilter.set(t)}getClefFilter(){return this.clefFilter()}setNoteFilter(t){this.noteFilter.set(t)}getNoteFilter(){return this.noteFilter()}buildSelectionContext(t){let e=this.progressService.getCurrentProgress();return{currentLevel:t?.currentLevel??this.currentLevel(),userProgress:t?.userProgress??e,performanceMap:t?.performanceMap??this.performanceData(),recentHistory:t?.recentHistory??this.recentHistory(),sessionContext:t?.sessionContext??{sessionStartTime:e.sessionStartTime,questionsThisSession:e.totalQuestionsAnswered,accuracyThisSession:e.overallAccuracy}}}buildCandidatePool(t){let e=this.getCurrentLevelConfig(),n=[];["treble","bass"].forEach(u=>{let C=u==="treble"?e.noteRange.trebleRange:e.noteRange.bassRange;for(let b=C.min;b<=C.max;b++)e.noteRange.allowedNotes.forEach(T=>{let z=`${T}${b}-${u}`,j=this.determineStaffPosition(T,b,u);n.push({name:T,octave:b,clef:u,position:j,id:z}),e.noteRange.includeAccidentals&&(n.push({name:T,octave:b,clef:u,accidental:"sharp",position:j,id:`${z}-sharp`}),n.push({name:T,octave:b,clef:u,accidental:"flat",position:j,id:`${z}-flat`}))})});let r=n,d=this.difficultyMode();d!=="default"&&(r=r.filter(u=>{let C=`${u.name}${u.octave}`;return(u.clef==="treble"?pe.treble:pe.bass)[d].includes(C)}));let g=this.clefFilter();g!=="both"&&(r=r.filter(u=>u.clef===g));let m=this.noteFilter();return m!=="all"&&(r=r.filter(u=>u.name===m)),r}calculateWeights(t,e){let n=this.getCurrentLevelConfig();return t.map(i=>{let r=n.baseWeights.get(i.id)??1,d=e.performanceMap.get(i.id);if(d){let u=1-d.accuracy;r*=1+u*2,d.consecutiveIncorrect>0&&(r*=1+d.consecutiveIncorrect*.5),d.consecutiveCorrect>3&&(r*=.7)}else r*=1.3;let g=e.recentHistory.findIndex(u=>u.id===i.id);if(g!==-1){let u=Math.max(.1,1-(g+1)*.3);r*=u}let m=i.clef==="treble"?n.clefDistribution.trebleWeight:n.clefDistribution.bassWeight;return r*=m,A(E({},i),{weight:Math.max(.01,r)})})}performWeightedSelection(t){let e=t.reduce((m,u)=>m+u.weight,0),n=Math.random()*e;for(let m of t)if(n-=m.weight,n<=0){let d=m,{weight:u}=d;return ae(d,["weight"])}let g=t[t.length-1],{weight:i}=g;return ae(g,["weight"])}updatePerformanceData(t,e,n){let i=this.performanceData(),r=i.get(t.id),d=(r?.attempts??0)+1,g=(r?.correctAnswers??0)+(e?1:0),m=g/d,u=r?(r.averageResponseTime*r.attempts+n)/d:n,C=e?(r?.consecutiveCorrect??0)+1:0,b=e?0:(r?.consecutiveIncorrect??0)+1,T=Math.round((1-m)*100),z={noteId:t.id,attempts:d,correctAnswers:g,accuracy:m,lastSeen:new Date,averageResponseTime:u,consecutiveCorrect:C,consecutiveIncorrect:b,difficultyScore:T},j=new Map(i);j.set(t.id,z),this.performanceData.set(j)}updateHistory(t){let e=this.recentHistory(),i=[t,...e.slice(0,10-1)];this.recentHistory.set(i)}checkLevelProgression(){let t=this.getCurrentLevelConfig(),e=this.progressService.getCurrentProgress(),n=e.overallAccuracy>=t.progressionCriteria.minAccuracy,i=e.totalQuestionsAnswered>=t.progressionCriteria.minQuestions,d=this.countRecentCorrectAnswers()>=t.progressionCriteria.consecutiveCorrect;n&&i&&d&&this.advanceLevel()}countRecentCorrectAnswers(){return 0}advanceLevel(){let t=this.currentLevel(),e=["easy","hard"],n=e.indexOf(t);if(n<e.length-1){let i=e[n+1];this.currentLevel.set(i),this.progressService.updateLevel(i)}}determineStaffPosition(t,e,n){let i=`${t}${e}`;if(n==="treble"){let r=["E4","G4","B4","D5","F5"],d=["F4","A4","C5","E5"];if(r.includes(i))return"line";if(d.includes(i))return"space";if(e<4||e===4&&["C","D"].includes(t))return"ledger-below";if(e>5||e===5&&["G","A","B"].includes(t)||e>=6)return"ledger-above"}else{let r=["G2","B2","D3","F3","A3"],d=["A2","C3","E3","G3"];if(r.includes(i))return"line";if(d.includes(i))return"space";if(e<2||e===2&&["E","F"].includes(t))return"ledger-below";if(e>3||e===3&&["B"].includes(t)||e>=4)return"ledger-above"}return"space"}persistPerformanceData(){this.storageService.save("performance-data",Array.from(this.performanceData().entries())),this.storageService.save("recent-history",this.recentHistory()),this.storageService.save("current-level",this.currentLevel())}loadPerformanceData(){let t=this.storageService.load("performance-data");t&&this.performanceData.set(new Map(t));let e=this.storageService.load("recent-history");e&&this.recentHistory.set(e);let n=this.storageService.load("current-level");n&&this.currentLevel.set(n)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};var it=(o,t)=>t.y;function rt(o,t){if(o&1&&s(0),o&2){let e=f();ke(" ",e.clef()," clef showing note on ",e.notePositionDescription(),". ")}}function st(o,t){if(o&1&&s(0),o&2){let e=f();F(" ",e.clef()," clef with no note displayed. ")}}function at(o,t){if(o&1&&(G(),J(0,"line",3)),o&2){let e=t.$implicit,n=f();M("y1",e)("x2",n.staffWidth-50)("y2",e)}}function ct(o,t){if(o&1&&(G(),J(0,"line",6)),o&2){let e=t.$implicit;M("x1",e.x1)("y1",e.y)("x2",e.x2)("y2",e.y)}}function lt(o,t){if(o&1&&L(0,ct,1,4,":svg:line",6,it),o&2){let e=f();B(e.ledgerLines())}}function dt(o,t){if(o&1&&(G(),D(0,"text",7),s(1),S()),o&2){let e=t,n=f(2);M("x",e.x)("y",e.y+6),l(),F(" ",n.getAccidentalSymbol(n.currentNote().accidental)," ")}}function ut(o,t){if(o&1&&(v(0,dt,2,3,":svg:text",7),G(),D(1,"g"),J(2,"ellipse",8),S()),o&2){let e,n=t,i=f();x((e=i.shouldShowAccidental()&&i.getAccidentalPosition())?0:-1,e),l(),M("transform","translate("+n.x+","+n.y+") rotate(20) scale(1.2, 1.1)"),l(),M("rx",i.noteRadius)("ry",i.noteRadius*.7)}}function ft(o,t){if(o&1&&(G(),D(0,"text",5),s(1,' Click "New Note" to start '),S()),o&2){let e=f();M("x",e.staffCenterX)("y",e.staffCenterY)}}var re=class o{currentNote=H(null);showNote=H(!0);showResult=H(!1);clef=H("treble");highlightNote=H(!1);staffLines=p([]);notePosition=p(null);staffHeight=300;staffWidth=330;lineSpacing=18;noteRadius=9.5;staffCenterY=150;staffCenterX=165;staffLinePositions=_(()=>{let t=this.lineSpacing,e=this.staffCenterY;return[e-t*2,e-t,e,e+t,e+t*2]});clefSymbol=_(()=>this.clef()==="treble"?"\u{1D11E}":"\u{1D122}");noteDisplayPosition=_(()=>{let t=this.currentNote();return!t||!this.showNote()?null:this.calculateNotePosition(t)});ledgerLines=_(()=>{let t=this.currentNote();return!t||!this.showNote()?[]:this.calculateLedgerLines(t)});notePositionDescription=_(()=>{let t=this.currentNote();if(!t)return"";let e=this.staffLinePositions(),n=this.calculateNotePosition(t),i=this.lineSpacing,r=e[0],d=e[4],g,m,u;if(n.y<r){g="above staff";let C=Math.round((r-n.y)/(i/2));m=Math.ceil(C/2),u=C%2===0?"line":"space"}else if(n.y>d){g="below staff";let C=Math.round((n.y-d)/(i/2));m=Math.ceil(C/2),u=C%2===0?"line":"space"}else{g="on staff";let C=Math.round((d-n.y)/(i/2));C%2===0?(u="line",m=C/2+1):(u="space",m=Math.ceil(C/2))}return`${u} ${m}, ${g}`});constructor(){te(()=>{this.updateStaffForClef()})}calculateNotePosition(t){let e=this.staffLinePositions(),n=this.lineSpacing,r=this.staffCenterY;return t.clef==="treble"?r=this.calculateTreblePosition(t,e,n):r=this.calculateBassPosition(t,e,n),{x:this.staffCenterX,y:r}}calculateTreblePosition(t,e,n){let i=`${t.name}${t.octave}`;return{C4:e[4]+n,D4:e[4]+n/2,E4:e[4],F4:e[4]-n/2,G4:e[3],A4:e[3]-n/2,B4:e[2],C5:e[2]-n/2,D5:e[1],E5:e[1]-n/2,F5:e[0],G5:e[0]-n/2,A5:e[0]-n,B5:e[0]-n*1.5,C6:e[0]-n*2,D6:e[0]-n*2.5,E6:e[0]-n*3,F6:e[0]-n*3.5,G6:e[0]-n*4,A6:e[0]-n*4.5,B6:e[0]-n*5,C7:e[0]-n*5.5}[i]??e[2]}calculateBassPosition(t,e,n){let i=`${t.name}${t.octave}`;return{C1:e[4]+n*5.5,D1:e[4]+n*5,E1:e[4]+n*4.5,F1:e[4]+n*4,G1:e[4]+n*3.5,A1:e[4]+n*3,B1:e[4]+n*2.5,C2:e[4]+n*2,D2:e[4]+n*1.5,E2:e[4]+n*1,F2:e[4]+n*.5,G2:e[4],A2:e[4]-n/2,B2:e[3],C3:e[3]-n/2,D3:e[2],E3:e[2]-n/2,F3:e[1],G3:e[1]-n/2,A3:e[0],B3:e[0]-n/2,C4:e[0]-n,D4:e[0]-n*1.5,E4:e[0]-n*2,F4:e[0]-n*2.5,G4:e[0]-n*3,A4:e[0]-n*3.5,B4:e[0]-n*4,C5:e[0]-n*4.5}[i]??e[2]}calculateLedgerLines(t){let e=this.calculateNotePosition(t),n=this.staffLinePositions(),i=this.lineSpacing,r=[],d=e.y,g=n[0],m=n[4];if(d<g){let u=g-i;for(;u>=d-i/2;)r.push({y:u,x1:e.x-25,x2:e.x+25}),u-=i}if(d>m){let u=m+i;for(;u<=d+i/2;)r.push({y:u,x1:e.x-25,x2:e.x+25}),u+=i}return r}updateStaffForClef(){let t=[0,1,2,3,4];this.staffLines.set(t)}getAccidentalSymbol(t){return{sharp:"\u266F",flat:"\u266D"}[t]||""}shouldShowAccidental(){return!!(this.currentNote()?.accidental&&this.showNote())}getAccidentalPosition(){let t=this.noteDisplayPosition();return!t||!this.shouldShowAccidental()?null:{x:t.x-20,y:t.y}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-musical-staff"]],inputs:{currentNote:[1,"currentNote"],showNote:[1,"showNote"],showResult:[1,"showResult"],clef:[1,"clef"],highlightNote:[1,"highlightNote"]},decls:12,vars:9,consts:[["tabindex","0","aria-labelledby","current-question",1,"musical-staff-container"],["role","status","aria-live","assertive","id","current-question","aria-atomic","true",1,"sr-only"],["preserveAspectRatio","xMidYMid slice","role","img","aria-hidden","true",1,"staff-svg"],["x1","50","stroke","#000","stroke-width","2",1,"staff-line"],["font-family","serif","fill","#000","text-anchor","middle",1,"clef-symbol"],["font-family","Arial, sans-serif","font-size","16","fill","#666","text-anchor","middle",1,"placeholder-text"],["stroke","#000","stroke-width","2",1,"ledger-line"],["font-family","serif","font-size","20","fill","#000","text-anchor","middle",1,"accidental"],["cx","0","cy","0","fill","none","stroke","#000","stroke-width","3.5",1,"note"]],template:function(e,n){if(e&1&&(D(0,"div",0)(1,"div",1),v(2,rt,1,2)(3,st,1,1),S(),G(),D(4,"svg",2),L(5,at,1,3,":svg:line",3,Ne),D(7,"text",4),s(8),S(),v(9,lt,2,0),v(10,ut,3,4),v(11,ft,2,2,":svg:text",5),S()()),e&2){let i,r,d;l(2),x((i=n.currentNote())?2:3,i),l(2),M("viewBox","0 0 "+n.staffWidth+" "+n.staffHeight),l(),B(n.staffLinePositions()),l(2),M("x",n.clef()==="bass"?85:75)("y",n.clef()==="bass"?n.staffCenterY+31:n.staffCenterY+20)("font-size",n.clef()==="bass"?"95":"85"),l(),F(" ",n.clefSymbol()," "),l(),x((r=n.showNote()&&n.currentNote())?9:-1,r),l(),x((d=n.showNote()&&n.noteDisplayPosition())?10:-1,d),l(),x(!n.showNote()||!n.currentNote()?11:-1)}},dependencies:[K],styles:[".musical-staff-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px 16px;background:#1a0035cc;border-radius:0;box-shadow:0 0 40px #ff00aa26;margin:0;border:1px solid rgba(102,51,153,.4);clip-path:polygon(12px 0,100% 0,calc(100% - 12px) 100%,0 100%);width:100%}.musical-staff-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:.75rem;letter-spacing:.15em;text-transform:uppercase;color:var(--electric-mint);margin-bottom:16px;font-weight:700;text-align:center}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{background:#1a0035;border:1px solid rgba(102,51,153,.3);border-radius:0;padding:20px;transition:all .3s ease;display:block;margin:0 auto;width:100%;height:auto}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]:hover{box-shadow:0 0 30px #f0a3;border-color:#f0a6}.musical-staff-container[_ngcontent-%COMP%]   .staff-line[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .ledger-line[_ngcontent-%COMP%]{stroke:var(--white)}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%]{font-family:Times New Roman,serif;font-weight:700;fill:var(--fuchsia);filter:drop-shadow(0 0 4px rgba(255,0,170,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--fuchsia);stroke-width:3.5;transition:all .2s ease;filter:drop-shadow(0 0 6px rgba(255,0,170,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note.highlighted[_ngcontent-%COMP%]{fill:none;stroke:var(--electric-mint);stroke-width:4;filter:drop-shadow(0 0 12px rgba(0,255,204,.8));animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.musical-staff-container[_ngcontent-%COMP%]   .note.accidental-sharp[_ngcontent-%COMP%]{stroke:#8e44ad;filter:drop-shadow(0 0 6px rgba(142,68,173,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note.accidental-flat[_ngcontent-%COMP%]{stroke:#16a085;filter:drop-shadow(0 0 6px rgba(22,160,133,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%]{stroke:var(--fuchsia);stroke-width:2;transition:all .2s ease;filter:drop-shadow(0 0 4px rgba(255,0,170,.4))}.musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{font-family:Times New Roman,serif;font-weight:700;fill:var(--pale-lavender);filter:drop-shadow(0 0 3px rgba(232,204,255,.4))}.musical-staff-container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;fill:#e8ccff4d;font-style:italic;font-size:14px;letter-spacing:.1em}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-top:20px;padding:12px 24px;background:#ff00aa1a;border:1px solid var(--fuchsia);border-radius:0;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%);font-family:Courier New,Courier,monospace;font-weight:700;color:var(--white);box-shadow:0 0 20px #f0a3;transition:all .3s ease}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 0 30px #f0a6}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:900;color:var(--fuchsia);text-shadow:0 0 10px rgba(255,0,170,.8)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-accidental[_ngcontent-%COMP%]{font-size:20px;color:var(--electric-mint);margin:0 4px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{font-size:18px;color:var(--pale-lavender);background:#6633994d;padding:2px 10px;border:1px solid var(--rebecca);clip-path:polygon(4px 0,100% 0,calc(100% - 4px) 100%,0 100%)}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}@media (max-width: 768px){.musical-staff-container[_ngcontent-%COMP%]{padding:12px}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{width:100%;max-width:none;height:auto;padding:15px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{padding:10px 20px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{font-size:20px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-accidental[_ngcontent-%COMP%]{font-size:16px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){.musical-staff-container[_ngcontent-%COMP%]{padding:10px}.musical-staff-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:12px}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{width:100%;max-width:none;padding:4px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{flex-direction:column;gap:6px;text-align:center}}@media (prefers-contrast: high){.musical-staff-container[_ngcontent-%COMP%]   .staff-line[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .ledger-line[_ngcontent-%COMP%]{stroke:var(--white);stroke-width:2}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--white);stroke-width:3.5}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{fill:var(--white)}}@media (prefers-reduced-motion: reduce){.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{transition:none}.musical-staff-container[_ngcontent-%COMP%]   .note.highlighted[_ngcontent-%COMP%]{animation:none}}@media (prefers-color-scheme: dark){.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{background:#0d0020;border-color:#66339980}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{fill:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%]{stroke:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{fill:#e8ccff4d}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{background:#ff00aa26;border-color:var(--fuchsia);color:var(--white)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{color:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{background:#6396;color:var(--pale-lavender)}}.musical-staff-container[_ngcontent-%COMP%]:focus-within{outline:2px solid var(--fuchsia);outline-offset:4px}"]})};var gt=["noteButtonElement"],pt=(o,t)=>t.note;function mt(o,t){o&1&&(D(0,"span",6),s(1),S()),o&2&&(l(),N(t))}function ht(o,t){if(o&1){let e=k();D(0,"button",4,0),Ae("click",function(){let i=P(e).$implicit,r=f();return w(r.onNoteClick(i.note))}),D(2,"span",5),s(3),S(),v(4,mt,2,1,"span",6),S()}if(o&2){let e,n=t.$implicit,i=f();M("aria-label","Select "+n.note),l(3),N(n.label),l(),x((e=i.getKeyboardShortcut(n.note))?4:-1,e)}}var se=class o{noteButtonElements;availableNotes=H(R);showAccidentals=H(!1);noteSelected=De();noteButtons=_(()=>{let t=this.availableNotes(),e=[];return t.forEach(n=>{e.push({note:n,label:n,class:"natural-note"})}),e.sort((n,i)=>{let r=R,d=r.indexOf(n.note),g=r.indexOf(i.note);return d-g})});keyboardShortcuts=_(()=>{let t={};return this.availableNotes().forEach((n,i)=>{let r=(i+1).toString();t[r]=n}),t});handleKeyboardEvent(t){t.key>="1"&&t.key<="7"&&(t.preventDefault(),this.onKeyboardShortcut(t.key))}onNoteClick(t){this.noteSelected.emit(t)}getKeyboardShortcut(t){let e=this.keyboardShortcuts();return Object.keys(e).find(i=>e[i]===t)||null}focusFirstAnswerOption(){this.noteButtonElements?.first?.nativeElement?.focus()}onKeyboardShortcut(t){let n=this.keyboardShortcuts()[t];n&&this.onNoteClick(n)}getNoteDisplayName(t){return t.replace("#","\u266F").replace("b","\u266D")}playNoteSound(t){console.log(`Playing note: ${t}`)}provideHapticFeedback(){"vibrate"in navigator&&navigator.vibrate(50)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-note-input"]],viewQuery:function(e,n){if(e&1&&q(gt,5),e&2){let i;Q(i=Z())&&(n.noteButtonElements=i)}},hostBindings:function(e,n){e&1&&y("keydown",function(r){return n.handleKeyboardEvent(r)},ve)},inputs:{availableNotes:[1,"availableNotes"],showAccidentals:[1,"showAccidentals"]},outputs:{noteSelected:"noteSelected"},decls:4,vars:2,consts:[["noteButtonElement",""],[1,"note-input-container"],["role","group",1,"note-buttons-grid"],["type","button",1,"note-button","natural"],["type","button",1,"note-button","natural",3,"click"],[1,"note-label"],[1,"keyboard-shortcut"]],template:function(e,n){e&1&&(D(0,"div",1)(1,"div",2),L(2,ht,5,3,"button",3,pt),S()()),e&2&&(l(),W("single-note-button-grid",n.noteButtons().length===1),l(),B(n.noteButtons()))},dependencies:[K],styles:['.note-input-container[_ngcontent-%COMP%]{position:relative;padding:0;background:transparent;border-radius:0;box-shadow:none;margin:0}.note-input-container[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(2,auto);gap:2px;margin-bottom:20px;max-width:650px;margin-left:auto;margin-right:auto;background:#6393;border:1px solid rgba(102,51,153,.3)}.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid.single-note-button-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.note-input-container[_ngcontent-%COMP%]   .input-instructions[_ngcontent-%COMP%]{font-size:.85rem;color:#fff;margin:0;font-style:italic;letter-spacing:.1em;font-family:Courier New,Courier,monospace;text-align:center}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 18px;border:none;border-radius:0;background:var(--violet-mid);color:var(--pale-lavender);font-family:Courier New,Courier,monospace;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:none;min-height:90px;overflow:hidden}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:3px;height:0;background:var(--fuchsia);transition:height .4s ease}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){background:var(--violet-surface);transform:none;box-shadow:none}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled):before{height:100%}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled)   .note-label[_ngcontent-%COMP%]{color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:focus{outline:3px solid var(--fuchsia);outline-offset:-2px;z-index:10}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:active:not(.disabled), .note-input-container[_ngcontent-%COMP%]   .note-button.pressed[_ngcontent-%COMP%]{background:#ff00aa1a;transform:none}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]{background:#ff00aa26;color:var(--white);border:none;box-shadow:inset 0 0 20px #ff00aa4d}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]:before{height:100%;width:4px}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:var(--fuchsia);text-shadow:0 0 10px rgba(255,0,170,.8)}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]   .keyboard-shortcut[_ngcontent-%COMP%]{background:#f0a3;color:var(--fuchsia);border-color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button.hovered[_ngcontent-%COMP%]:not(.disabled):not(.selected){background:var(--violet-surface)}.note-input-container[_ngcontent-%COMP%]   .note-button.disabled[_ngcontent-%COMP%]{opacity:.3;cursor:not-allowed;transform:none!important}.note-input-container[_ngcontent-%COMP%]   .note-button.disabled[_ngcontent-%COMP%]:before{display:none}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:900;margin-bottom:2px;transition:all .3s ease;letter-spacing:.05em}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .keyboard-shortcut[_ngcontent-%COMP%]{font-size:.7rem;background:#6633994d;color:#e8ccffe6;padding:2px 7px;border-radius:0;border:1px solid rgba(102,51,153,.4);font-weight:500;transition:all .3s ease;clip-path:polygon(3px 0,100% 0,calc(100% - 3px) 100%,0 100%);letter-spacing:.1em}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .selected-indicator[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;font-size:16px;color:var(--fuchsia);animation:_ngcontent-%COMP%_checkmark .3s ease;text-shadow:0 0 8px rgba(255,0,170,.8)}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]{margin-top:24px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]{background:#0d002099;border:1px solid rgba(102,51,153,.3);border-radius:0;overflow:hidden}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]{padding:12px 16px;background:#1a0035cc;cursor:pointer;font-weight:700;font-size:.8rem;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint);border:none;outline:none;transition:background-color .3s ease;font-family:Courier New,Courier,monospace}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]:hover{background:#220044e6}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]:focus{background:#220044e6;box-shadow:inset 0 0 0 2px var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcuts-list[_ngcontent-%COMP%]{padding:16px;display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 0}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]   .shortcut-key[_ngcontent-%COMP%]{background:var(--fuchsia);color:var(--violet-dark);padding:4px 10px;border-radius:0;font-size:.85rem;font-weight:900;min-width:28px;text-align:center;font-family:Courier New,Courier,monospace;clip-path:polygon(3px 0,100% 0,calc(100% - 3px) 100%,0 100%);letter-spacing:.05em}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]   .shortcut-note[_ngcontent-%COMP%]{font-weight:700;font-size:.85rem;color:var(--pale-lavender);font-family:Courier New,Courier,monospace}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0d0020e6;display:flex;align-items:center;justify-content:center;border-radius:0;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:100}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:24px 32px;background:var(--violet-surface);border-radius:0;border:1px solid var(--rebecca);box-shadow:0 0 30px #f0a3;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%)}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]   .disabled-icon[_ngcontent-%COMP%]{font-size:32px}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]   .disabled-text[_ngcontent-%COMP%]{font-weight:700;font-size:.8rem;letter-spacing:.1em;text-transform:uppercase;color:#e8ccff99;font-family:Courier New,Courier,monospace}@keyframes _ngcontent-%COMP%_checkmark{0%{transform:scale(0);opacity:0}50%{transform:scale(1.3)}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid[_ngcontent-%COMP%]{gap:2px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{padding:16px 8px;min-height:80px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .shortcuts-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}}@media (max-width: 480px){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{min-height:70px;padding:12px 6px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{font-size:1.8rem}}@media (prefers-contrast: high){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{border:2px solid var(--white)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){border-color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]{background:var(--fuchsia);color:var(--white);border-color:var(--fuchsia)}}@media (prefers-reduced-motion: reduce){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{transition:none}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:before{transition:none}.note-input-container[_ngcontent-%COMP%]   .selected-indicator[_ngcontent-%COMP%]{animation:none}}@media (prefers-color-scheme: dark){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{background:var(--violet-mid);color:var(--pale-lavender)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){background:var(--violet-surface)}}']})};var _t=["nextNoteButton"],bt=["noteInputComponent"],Ct=(o,t)=>t.mode,ze=(o,t)=>t.filter;function vt(o,t){if(o&1){let e=k();c(0,"li")(1,"button",44),y("click",function(i){let r=P(e).$implicit;f(2);let d=ee(7),g=f();return w(g.selectDifficulty(i,r.mode,d))}),c(2,"span",45),s(3),a(),c(4,"span",46),s(5),a()()()}if(o&2){let e=t.$implicit,n=f(3);l(),W("active",n.difficultyMode()===e.mode),l(2),N(e.label),l(2),N(e.description)}}function xt(o,t){if(o&1){let e=k();c(0,"ul",43),y("keydown",function(i){P(e);let r=f(2);return w(r.onMenuKeydown(i))}),L(1,vt,6,4,"li",null,Ct),a()}if(o&2){let e=f(2);$("cdkTrapFocusAutoCapture",!0),l(),B(e.difficultyModes)}}function Mt(o,t){if(o&1){let e=k();c(0,"li")(1,"button",47),y("click",function(i){let r=P(e).$implicit;f(2);let d=ee(17),g=f();return w(g.selectClef(i,r.filter,d))}),c(2,"span",45),s(3),a(),c(4,"span",46),s(5),a()()()}if(o&2){let e=t.$implicit,n=f(3);l(),W("active",n.clefFilter()===e.filter),l(2),N(e.label),l(2),N(e.description)}}function yt(o,t){if(o&1){let e=k();c(0,"ul",43),y("keydown",function(i){P(e);let r=f(2);return w(r.onMenuKeydown(i))}),L(1,Mt,6,4,"li",null,ze),a()}if(o&2){let e=f(2);$("cdkTrapFocusAutoCapture",!0),l(),B(e.clefFilters)}}function Pt(o,t){if(o&1){let e=k();c(0,"li")(1,"button",47),y("click",function(i){let r=P(e).$implicit;f(2);let d=ee(27),g=f();return w(g.selectNote(i,r.filter,d))}),c(2,"span",45),s(3),a(),c(4,"span",46),s(5),a()()()}if(o&2){let e=t.$implicit,n=f(3);l(),W("active",n.noteFilter()===e.filter),l(2),N(e.label),l(2),N(e.description)}}function wt(o,t){if(o&1){let e=k();c(0,"ul",43),y("keydown",function(i){P(e);let r=f(2);return w(r.onMenuKeydown(i))}),L(1,Pt,6,4,"li",null,ze),a()}if(o&2){let e=f(2);$("cdkTrapFocusAutoCapture",!0),l(),B(e.noteFilters)}}function Ot(o,t){if(o&1){let e=k();c(0,"div",11)(1,"div",32)(2,"div",33)(3,"span",34),s(4,"Level"),a(),c(5,"div",35)(6,"button",36,1),y("click",function(){P(e);let i=f();return w(i.toggleDifficultyDropdown())}),s(8),c(9,"span",37),s(10,"\u25BC"),a()(),v(11,xt,3,1,"ul",38),a()(),c(12,"div",33)(13,"span",34),s(14,"Clef"),a(),c(15,"div",35)(16,"button",36,2),y("click",function(){P(e);let i=f();return w(i.toggleClefDropdown())}),s(18),c(19,"span",37),s(20,"\u25BC"),a()(),v(21,yt,3,1,"ul",38),a()(),c(22,"div",33)(23,"span",34),s(24,"Note"),a(),c(25,"div",35)(26,"button",36,3),y("click",function(){P(e);let i=f();return w(i.toggleNoteDropdown())}),s(28),c(29,"span",37),s(30,"\u25BC"),a()(),v(31,wt,3,1,"ul",38),a()()(),c(32,"div",39)(33,"div",40)(34,"span",34),s(35,"Overall Accuracy:"),a(),c(36,"span",41),s(37),a()(),c(38,"div",40)(39,"span",34),s(40,"Question Number:"),a(),c(41,"span",42),s(42),a()()()()}if(o&2){let e=f();l(6),M("aria-expanded",e.showDifficultyDropdown())("aria-label","Select difficulty mode. Current: "+e.getCurrentDifficultyLabel()),l(2),F(" ",e.getCurrentDifficultyLabel()," "),l(3),x(e.showDifficultyDropdown()?11:-1),l(5),M("aria-expanded",e.showClefDropdown())("aria-label","Select clef filter. Current: "+e.getCurrentClefLabel()),l(2),F(" ",e.getCurrentClefLabel()," "),l(3),x(e.showClefDropdown()?21:-1),l(5),M("aria-expanded",e.showNoteDropdown())("aria-label","Select note filter. Current: "+e.getCurrentNoteLabel()),l(2),F(" ",e.getCurrentNoteLabel()," "),l(3),x(e.showNoteDropdown()?31:-1),l(5),W("high-accuracy",e.accuracyPercentage()>=80),l(),F(" ",e.accuracyPercentage(),"% "),l(5),N(t.totalQuestionsAnswered)}}function Nt(o,t){if(o&1&&Ee(0,"app-musical-staff",15),o&2){let e,n=t,i=f();$("currentNote",n)("clef",n.clef)("showNote",!0)("showResult",((e=i.feedback())==null?null:e.type)==="correct")}}function Et(o,t){o&1&&(c(0,"div",16)(1,"p"),s(2,"Loading musical note..."),a()())}function At(o,t){if(o&1){let e=k();c(0,"section",17)(1,"div",48)(2,"app-note-input",49,4),y("noteSelected",function(i){P(e);let r=f();return w(r.handleAnswer(i))}),a()()()}if(o&2){let e=f();l(2),$("availableNotes",e.filteredAvailableNotes())}}function kt(o,t){o&1&&s(0," Next Note ")}function Dt(o,t){o&1&&s(0," New Note ")}function St(o,t){if(o&1){let e=k();c(0,"button",50),y("click",function(){P(e);let i=f();return w(i.showAnswer())}),s(1),a()}if(o&2){let e=f();M("aria-label","Reveal the correct answer for this note"),l(),F(" ",e.showAnswerHint()?"Hide Answer Hint":"Give Me a Hint!"," ")}}function Tt(o,t){if(o&1&&(c(0,"div",53)(1,"span",56),s(2,"\u2713"),a(),c(3,"span",57),s(4),a()()),o&2){let e=f();l(4),N(e.message)}}function Ft(o,t){if(o&1&&(c(0,"div",54)(1,"span",56),s(2,"\u2717"),a(),c(3,"span",57),s(4),a()()),o&2){let e=f();l(4),N(e.message)}}function It(o,t){if(o&1&&(c(0,"div",55)(1,"span",56),s(2,"\u{1F4A1}"),a(),c(3,"span",57),s(4),a()()),o&2){let e=f();l(4),N(e.message)}}function Rt(o,t){if(o&1&&(c(0,"section",22)(1,"h2",51),s(2,"Answer Feedback"),a(),c(3,"div",52),v(4,Tt,5,1,"div",53)(5,Ft,5,1,"div",54)(6,It,5,1,"div",55),a()()),o&2){let e;l(4),x((e=t.type)==="correct"?4:e==="incorrect"?5:e==="hint"?6:-1)}}var $e=class o{constructor(t){this.renderer=t}nextNoteButton;noteInputComponent;currentNote=p(null);userProgress=p(null);feedback=p(null);isProcessing=p(!1);hasAnswered=p(!1);sessionStartTime=p(new Date);questionStartTime=p(new Date);showAnswerHint=p(!1);difficultyMode=p("default");showDifficultyDropdown=p(!1);difficultyModes=je;clefFilter=p("both");showClefDropdown=p(!1);clefFilters=Ve;noteFilter=p("all");showNoteDropdown=p(!1);noteFilters=We;pendingAnswer=p(null);showAnswerInput=_(()=>this.currentNote()&&!this.hasAnswered());canGenerateNew=_(()=>!this.isProcessing());accuracyPercentage=_(()=>{let t=this.userProgress();return t?Math.round(t.overallAccuracy*100):0});availableNotes=["C","D","E","F","G","A","B"];noteGenerator=h(ie);progressService=h(Y);ngOnInit(){this.loadUserProgress(),this.generateNewNote()}ngOnDestroy(){this.saveProgress()}onDocumentClick(t){t.target.closest(".difficulty-dropdown")||(this.showDifficultyDropdown()&&(this.enableBackground(),this.showDifficultyDropdown.set(!1)),this.showClefDropdown()&&(this.enableBackground(),this.showClefDropdown.set(!1)),this.showNoteDropdown()&&(this.enableBackground(),this.showNoteDropdown.set(!1)))}onEscapeKey(){this.showDifficultyDropdown()&&(this.enableBackground(),this.showDifficultyDropdown.set(!1)),this.showClefDropdown()&&(this.enableBackground(),this.showClefDropdown.set(!1)),this.showNoteDropdown()&&(this.enableBackground(),this.showNoteDropdown.set(!1))}onMenuKeydown(t){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault()}enableBackground(){this.renderer.removeClass(document.body,"no-scroll")}disableBackground(){this.renderer.addClass(document.body,"no-scroll")}generateNewNote(t){this.showAnswerHint.set(!1);let e=this.pendingAnswer();e&&(this.noteGenerator.recordAnswer(e.note,e.userAnswer,e.isCorrect,e.responseTime),this.progressService.recordQuestionAttempt(e.isCorrect,e.responseTime),this.pendingAnswer.set(null),setTimeout(()=>this.updateProgress(),0)),this.isProcessing.set(!0),this.hasAnswered.set(!1),this.feedback.set(null),this.questionStartTime.set(new Date);try{let n=this.noteGenerator.generateNextNote();this.currentNote.set(n)}catch(n){console.error("Error generating note:",n),this.feedback.set({type:"incorrect",message:"Error generating note. Please try again."})}finally{let n=this.isRealMouseClick(t);t&&!n&&requestAnimationFrame(()=>{setTimeout(()=>{this.noteInputComponent?.focusFirstAnswerOption()})}),this.isProcessing.set(!1)}}isRealMouseClick(t){return t?.detail&&!t?.isPrimary}handleAnswer(t){let e=this.currentNote();if(!e||this.hasAnswered())return;let n=this.validateAnswer(t,e),i=this.calculateResponseTime();this.pendingAnswer.set({note:e,userAnswer:t,isCorrect:n,responseTime:i}),this.showFeedback(n,e,t),this.hasAnswered.set(!0),setTimeout(()=>{this.nextNoteButton?.nativeElement.focus()},100)}showAnswer(){let t=this.currentNote();this.showAnswerHint()?this.feedback.set(null):t&&this.feedback.set({type:"hint",message:`The correct note is next to the ${this.getRandomAdjacentNote(t.name)} note.`}),this.showAnswerHint.set(!this.showAnswerHint())}getRandomAdjacentNote(t){let e=R.indexOf(t);if(e>-1){let n=(e-1+R.length)%R.length,i=(e+1)%R.length,r=[R[n],R[i]];if(r)return r[Math.floor(Math.random()*2)]}return""}resetProgress(){confirm("Are you sure you want to reset all progress? This cannot be undone.")&&(this.noteGenerator.resetProgress(),this.progressService.resetProgress(),this.loadUserProgress(),this.generateNewNote(),this.feedback.set({type:"hint",message:"Progress has been reset. Starting over!"}))}filteredAvailableNotes=_(()=>{let t=this.noteFilter();return t==="all"?this.availableNotes:[t]});toggleDifficultyDropdown(){this.showDifficultyDropdown.update(t=>!t),this.showDifficultyDropdown()&&(this.showClefDropdown.set(!1),this.showNoteDropdown.set(!1),this.disableBackground())}selectDifficulty(t,e,n){this.difficultyMode.set(e),this.showDifficultyDropdown.set(!1),this.noteGenerator.setDifficultyMode(e),this.generateNewNote(),this.enableBackground();let i=this.isRealMouseClick(t);t&&!i&&requestAnimationFrame(()=>{setTimeout(()=>{n?.focus()})})}getCurrentDifficultyLabel(){return this.difficultyModes.find(e=>e.mode===this.difficultyMode())?.label||"Default"}toggleClefDropdown(){this.showClefDropdown.update(t=>!t),this.showClefDropdown()&&(this.showDifficultyDropdown.set(!1),this.showNoteDropdown.set(!1),this.disableBackground())}selectClef(t,e,n){this.clefFilter.set(e),this.showClefDropdown.set(!1),this.noteGenerator.setClefFilter(e),this.generateNewNote(),this.enableBackground();let i=this.isRealMouseClick(t);t&&!i&&requestAnimationFrame(()=>{setTimeout(()=>{n?.focus()})})}getCurrentClefLabel(){return this.clefFilters.find(e=>e.filter===this.clefFilter())?.label||"Both"}toggleNoteDropdown(){this.showNoteDropdown.update(t=>!t),this.showNoteDropdown()&&(this.showDifficultyDropdown.set(!1),this.showClefDropdown.set(!1),this.disableBackground())}selectNote(t,e,n){this.noteFilter.set(e),this.showNoteDropdown.set(!1),this.noteGenerator.setNoteFilter(e),this.generateNewNote(),this.enableBackground();let i=this.isRealMouseClick(t);t&&!i&&requestAnimationFrame(()=>{setTimeout(()=>{n?.focus()})})}getCurrentNoteLabel(){return this.noteFilters.find(e=>e.filter===this.noteFilter())?.label||"All"}validateAnswer(t,e){return t.replace(/[#b]/g,"").toUpperCase()===e.name}calculateResponseTime(){let t=this.questionStartTime();return new Date().getTime()-t.getTime()}showFeedback(t,e,n){let i=`${e.name}`;if(t){let r=["Excellent! \u{1F3B5}","Perfect! \u{1F3B6}","Great job! \u2728","Correct! \u{1F31F}","Well done! \u{1F44F}","Prrrrfect answer! \u{1F63A}","Rock on! \u{1F918}","Nailed it! \u26A1","Cowabunga dude! \u{1F422}"],d=r[Math.floor(Math.random()*r.length)];this.feedback.set({type:"correct",message:`${d}
The correct answer is "${i}".`})}else this.feedback.set({type:"incorrect",message:`Not quite.
You answered "${n}", the correct answer is "${i}".`})}loadUserProgress(){try{let t=this.progressService.getCurrentProgress();this.userProgress.set(t)}catch(t){console.error("Error loading user progress:",t),this.userProgress.set({currentLevel:"easy",totalQuestionsAnswered:0,overallAccuracy:0,sessionStartTime:new Date,levelProgression:[]})}}updateProgress(){try{let t=this.progressService.getCurrentProgress();this.userProgress.set(t)}catch(t){console.error("Error updating progress:",t)}}saveProgress(){try{this.progressService.saveProgress()}catch(t){console.error("Error saving progress:",t)}}static \u0275fac=function(e){return new(e||o)(Pe(ye))};static \u0275cmp=V({type:o,selectors:[["app-note-tutor"]],viewQuery:function(e,n){if(e&1&&(q(_t,5),q(bt,5)),e&2){let i;Q(i=Z())&&(n.nextNoteButton=i.first),Q(i=Z())&&(n.noteInputComponent=i.first)}},hostBindings:function(e,n){e&1&&y("click",function(r){return n.onDocumentClick(r)},ce)("keydown.escape",function(){return n.onEscapeKey()},ce)},decls:132,vars:10,consts:[["nextNoteButton",""],["difficultyDropdownButton",""],["clefDropdownButton",""],["noteDropdownButton",""],["noteInputComponent",""],[1,"note-tutor-container"],[1,"game-header"],[1,"line-1"],[1,"line-2"],["aria-labelledby","progress-heading",1,"progress-section"],["id","progress-heading",1,"sr-only"],[1,"stats-grid"],["role","main",1,"game-area"],["id","staff-heading",1,"instruction-text","staff-heading"],[1,"staff-section"],[1,"staff-container",3,"currentNote","clef","showNote","showResult"],["role","status","aria-live","polite",1,"staff-placeholder"],["aria-labelledby","input-heading",1,"input-section"],["aria-labelledby","controls-heading",1,"controls-section"],[1,"controls"],["type","button",1,"btn","btn-primary","next-note",3,"click","disabled"],["type","button",1,"btn","btn-secondary"],["aria-labelledby","feedback-heading",1,"feedback-section"],[1,"reset-controls"],["type","button",1,"btn","btn-outline",3,"click"],["aria-labelledby","instructions-heading",1,"instructions-panel"],["id","instructions-heading"],[1,"instructions-content"],[1,"instructions-list"],[1,"instruction-header"],[1,"tips-section"],[1,"tips-list"],[1,"stat-line","options-stat-line"],[1,"stat-item","difficulty-selector"],[1,"stat-label"],[1,"difficulty-dropdown"],["type","button",1,"stat-value","level-badge","difficulty-button",3,"click"],[1,"dropdown-arrow"],["role","menu","cdkTrapFocus","",1,"difficulty-menu",3,"cdkTrapFocusAutoCapture"],[1,"stat-line"],[1,"stat-item"],[1,"stat-value","accuracy-display"],[1,"stat-value"],["role","menu","cdkTrapFocus","",1,"difficulty-menu",3,"keydown","cdkTrapFocusAutoCapture"],["tabindex","0","type","button","role","menuitem",1,"difficulty-option",3,"click"],[1,"option-label"],[1,"option-description"],["type","button","role","menuitem",1,"difficulty-option",3,"click"],[1,"input-container"],[1,"answer-input",3,"noteSelected","availableNotes"],["type","button",1,"btn","btn-secondary",3,"click"],["id","feedback-heading",1,"sr-only"],[1,"feedback-container"],["role","alert","aria-live","assertive",1,"feedback","success"],["role","alert","aria-live","assertive",1,"feedback","error"],["role","status","aria-live","polite",1,"feedback","hint"],["aria-hidden","true",1,"feedback-icon"],[1,"feedback-message"]],template:function(e,n){if(e&1){let i=k();c(0,"div",5)(1,"header",6)(2,"h1")(3,"span",7),s(4,"NOTE AND SEEK"),a(),c(5,"span")(6,"span",8),s(7,"THE MUSIC NOTE TUTOR"),a()()()(),c(8,"section",9)(9,"h2",10),s(10,"Game Settings and Progress"),a(),v(11,Ot,43,16,"div",11),a(),c(12,"main",12)(13,"h2",13),s(14,"Which note is displayed on the staff?"),a(),c(15,"section",14),v(16,Nt,1,4,"app-musical-staff",15)(17,Et,3,0,"div",16),a(),v(18,At,4,1,"section",17),c(19,"section",18)(20,"div",19)(21,"button",20,0),y("click",function(d){return P(i),w(n.generateNewNote(d))}),v(23,kt,1,0)(24,Dt,1,0),a(),v(25,St,2,2,"button",21),a()(),v(26,Rt,7,1,"section",22),c(27,"section",23)(28,"button",24),y("click",function(){return P(i),w(n.resetProgress())}),s(29," Reset Progress "),a()()(),c(30,"aside",25)(31,"h2",26),s(32,"How to Play"),a(),c(33,"div",27)(34,"ol",28)(35,"li",29),s(36,"Choose your "),c(37,"strong"),s(38,"Difficulty"),a(),s(39," level: "),c(40,"ul")(41,"li")(42,"strong"),s(43,"Default:"),a(),s(44," All note positions (staff + ledger lines)"),a(),c(45,"li")(46,"strong"),s(47,"Easy:"),a(),s(48," Only notes on the staff lines and spaces"),a(),c(49,"li")(50,"strong"),s(51,"Hard:"),a(),s(52," Only notes on ledger lines above and below staff"),a()()(),c(53,"li",29),s(54,"Select your "),c(55,"strong"),s(56,"Clef"),a(),s(57," preference: "),c(58,"ul")(59,"li")(60,"strong"),s(61,"Both:"),a(),s(62," Practice treble and bass clef notes"),a(),c(63,"li")(64,"strong"),s(65,"Treble:"),a(),s(66," Focus on treble clef only"),a(),c(67,"li")(68,"strong"),s(69,"Bass:"),a(),s(70," Focus on bass clef only"),a()()(),c(71,"li",29),s(72,"Choose a "),c(73,"strong"),s(74,"Note"),a(),s(75," to practice: "),c(76,"ul")(77,"li")(78,"strong"),s(79,"All:"),a(),s(80," Practice all notes (C through B)"),a(),c(81,"li")(82,"strong"),s(83,"C, D, E, F, G, A, or B:"),a(),s(84," Focus on a single note for targeted practice"),a()()(),c(85,"li",29),s(86,"Identify which note is displayed on the staff and select the correct answer from the options "),c(87,"ul")(88,"li"),s(89,"Use "),c(90,"strong"),s(91,"keys 1-7"),a(),s(92," to easily select the correct note from C to B. Single note mode only uses the 1 key."),a(),c(93,"li"),s(94,"If you're stuck, you can show the answer's hint to help you out."),a()()(),c(95,"li",29),s(96,"Your progress is tracked "),c(97,"ul")(98,"li"),s(99,"Progress is tracked between all game modes, to help identify areas needed to focus on."),a()()()(),c(100,"div",30)(101,"h3"),s(102,"Tips for Success:"),a(),c(103,"ul",31)(104,"li"),s(105,"Start with "),c(106,"strong"),s(107,"Easy"),a(),s(108," difficulty and a single "),c(109,"strong"),s(110,"Note"),a(),s(111," to build confidence"),a(),c(112,"li"),s(113,'Use mnemonics like "Every Good Boy Does Fine" for treble clef lines'),a(),c(114,"li"),s(115,"Practice one clef and one note at a time before combining"),a(),c(116,"li"),s(117,"Once comfortable with individual notes, switch to "),c(118,"strong"),s(119,"All"),a(),s(120," notes for full practice"),a(),c(121,"li"),s(122,"Progress to "),c(123,"strong"),s(124,"Hard"),a(),s(125," difficulty to master ledger lines"),a(),c(126,"li"),s(127,"Practice regularly to build muscle memory"),a(),c(128,"li"),s(129,"Don't worry about mistakes - they help you learn!"),a(),c(130,"li"),s(131,"Reset progress if you want to start from scratch and see how your previous training has helped."),a()()()()()()}if(e&2){let i,r,d;l(11),x((i=n.userProgress())?11:-1,i),l(5),x((r=n.currentNote())?16:17,r),l(2),x(n.showAnswerInput()?18:-1),l(3),W("next-note-enabled",n.hasAnswered()),$("disabled",!n.canGenerateNew()),l(2),x(n.hasAnswered()?23:24),l(2),x(n.showAnswerInput()?25:-1),l(),x((d=n.feedback())?26:-1,d),l(2),M("aria-label","Reset all progress")}},dependencies:[K,re,se,ge],styles:['.note-tutor-container[_ngcontent-%COMP%]{min-height:100vh;display:grid;grid-template-areas:"header header" "progress progress" "main instructions" "main instructions";grid-template-columns:1fr .33fr;grid-template-rows:auto auto 1fr auto;gap:2px;padding:0;background:var(--violet-dark);font-family:Courier New,Courier,monospace;position:relative}@media (max-width: 1024px){.note-tutor-container[_ngcontent-%COMP%]{grid-template-areas:"header" "progress" "main" "instructions";grid-template-columns:1fr;grid-template-rows:auto auto 1fr auto}}.game-header[_ngcontent-%COMP%]{grid-area:header;display:flex;justify-content:space-between;align-items:center;padding:24px 40px;background:#0d0020d9;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid var(--rebecca)}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-family:Courier New,Courier,monospace;font-size:clamp(1.8rem,1.5vw,2.4rem);font-weight:900;line-height:.9;letter-spacing:-.02em;display:flex;flex-direction:column;align-items:flex-start}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .line-1[_ngcontent-%COMP%]{color:var(--white)}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .line-2[_ngcontent-%COMP%]{color:var(--fuchsia);text-shadow:0 0 60px rgba(255,0,170,.8),0 0 120px rgba(255,0,170,.4);animation:glow 5s ease-in-out infinite}.progress-section[_ngcontent-%COMP%]{grid-area:progress;background:var(--violet-surface);border-top:1px solid rgba(102,51,153,.4);border-bottom:1px solid rgba(102,51,153,.4);padding:16px 32px}.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:32px}.progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{display:inline-flex;gap:80px;justify-content:center}.progress-section[_ngcontent-%COMP%]   .options-stat-line[_ngcontent-%COMP%]{gap:40px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:clamp(1.05rem,1.5vw,1.1rem);font-weight:900;letter-spacing:.2em;text-transform:uppercase;color:var(--pale-lavender);margin-bottom:6px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:2.5rem;font-weight:900;color:var(--fuchsia);text-shadow:0 0 20px rgba(255,0,170,.6);line-height:1}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.level-badge[_ngcontent-%COMP%]{font-size:clamp(1.6rem,1.5vw,2rem);padding:6px 14px;border:1px solid var(--fuchsia);clip-path:polygon(6px 0,100% 0,calc(100% - 6px) 100%,0 100%);text-transform:capitalize;text-shadow:none}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.level-badge[_ngcontent-%COMP%]:focus{outline:var(--electric-mint) auto 2px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.accuracy-display[_ngcontent-%COMP%]{color:var(--electric-mint);text-shadow:0 0 20px rgba(0,255,204,.6)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.accuracy-display.high-accuracy[_ngcontent-%COMP%]{animation:glow 8s ease-in-out infinite}.progress-section[_ngcontent-%COMP%]   .stat-item.difficulty-selector[_ngcontent-%COMP%], .progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-dropdown[_ngcontent-%COMP%]{position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]{cursor:pointer;background:transparent;border:1px solid var(--fuchsia);display:flex;align-items:center;gap:8px;transition:all .3s ease}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]:hover{background:#ff00aa1a;box-shadow:0 0 20px #ff00aa4d}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{font-size:.6rem;transition:transform .3s ease}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[aria-expanded=true][_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{transform:rotate(180deg)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 8px);list-style:none;left:50%;transform:translate(-50%);background:var(--violet-surface);border:1px solid var(--fuchsia);box-shadow:0 0 20px #f0a6;z-index:1000;min-width:280px;overflow:auto;pointer-events:all}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;padding:12px 16px;background:transparent;border:none;border-bottom:1px solid rgba(102,51,153,.3);width:100%;cursor:pointer;transition:all .3s ease;text-align:left}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]:last-child{border-bottom:none}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]:hover{background:#ff00aa1a}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option.active[_ngcontent-%COMP%]{background:#ff00aa26;border-left:3px solid var(--electric-mint)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]:focus{outline:var(--electric-mint) auto 2px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:clamp(1.05rem,1vw,1.8rem);font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--fuchsia);margin-bottom:4px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]   .option-description[_ngcontent-%COMP%]{font-size:clamp(1rem,1.5vw,1.2rem);color:#e8ccff99;line-height:1.4}.game-area[_ngcontent-%COMP%]{grid-area:main;display:flex;flex-direction:column;gap:28px;padding:40px 32px;background:var(--violet-mid);min-height:600px;position:relative;overflow:hidden}.game-area[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-image:linear-gradient(rgba(102,51,153,.1) 1px,transparent 1px),linear-gradient(90deg,rgba(102,51,153,.1) 1px,transparent 1px);background-size:40px 40px;pointer-events:none}@keyframes _ngcontent-%COMP%_gridScroll{0%{background-position:0 0}to{background-position:40px 40px}}.game-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;z-index:1}.game-area[_ngcontent-%COMP%]   .instruction-text[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:900;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint);text-align:center;margin:0}.staff-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:250px;padding:6px 12px;background:#0d002099;border:1px solid rgba(102,51,153,.3);clip-path:polygon(12px 0,100% 0,calc(100% - 12px) 100%,0 100%)}.staff-section[_ngcontent-%COMP%]   .staff-container[_ngcontent-%COMP%]{width:100%;max-width:600px}.staff-section[_ngcontent-%COMP%]   .staff-placeholder[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;color:#e8ccff66;font-style:italic;font-size:.9rem;letter-spacing:.1em}.input-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:24px}.input-section[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;width:100%;max-width:550px}.input-section[_ngcontent-%COMP%]   .answer-input[_ngcontent-%COMP%]{width:100%}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;color:var(--pale-lavender)}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid rgba(102,51,153,.3);border-top:3px solid var(--fuchsia);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;letter-spacing:.1em;text-transform:uppercase}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.feedback-section[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.feedback-section[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]{width:100%;max-width:600px}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:24px 16px;font-weight:900;font-size:1.5rem;letter-spacing:.05em;animation:_ngcontent-%COMP%_fadeInUp .1s ease-out;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%);border:1px solid}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   .feedback-icon[_ngcontent-%COMP%]{font-size:3rem;flex-shrink:0}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   .feedback-message[_ngcontent-%COMP%]{flex:1;white-space:pre-wrap;line-height:2.1rem}.feedback-section[_ngcontent-%COMP%]   .feedback.success[_ngcontent-%COMP%]{background:#00ffcc1a;color:var(--electric-mint);border-color:var(--electric-mint);box-shadow:0 0 20px #0fc3}.feedback-section[_ngcontent-%COMP%]   .feedback.success[_ngcontent-%COMP%]   .feedback-icon[_ngcontent-%COMP%]{animation:pulse 1s ease-in-out infinite}.feedback-section[_ngcontent-%COMP%]   .feedback.error[_ngcontent-%COMP%]{background:#f0a3;color:var(--fuchsia);border-color:var(--fuchsia);box-shadow:0 0 20px #f0a3}.feedback-section[_ngcontent-%COMP%]   .feedback.hint[_ngcontent-%COMP%]{background:#e8ccff0d;color:var(--pale-lavender);border-color:var(--rebecca)}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.controls-section[_ngcontent-%COMP%]{display:flex;justify-content:center}.controls-section[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;gap:24px;flex-wrap:wrap;justify-content:center}.controls-section[_ngcontent-%COMP%]   .next-note-enabled[_ngcontent-%COMP%]{margin:24px 0;padding:32px 128px;width:100%;text-wrap:nowrap}.reset-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:24px}.instructions-panel[_ngcontent-%COMP%]{grid-area:instructions;padding:40px 24px;background:#0d0020d9;border-left:1px solid rgba(102,51,153,.4);height:100%;overflow-y:auto}.instructions-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 24px;font-size:1.2rem;font-weight:900;letter-spacing:.05em;color:var(--white);text-transform:uppercase}.instructions-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"// ";color:var(--fuchsia)}.instructions-panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:32px 0 16px;font-size:1.2rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint)}.instructions-panel[_ngcontent-%COMP%]   .instructions-content[_ngcontent-%COMP%]{color:#e8ccffb3}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]{margin:0;padding-inline-start:40px;line-height:1.8}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:clamp(1.2rem,1vw,1.01rem);margin-bottom:6px;color:#e8ccffe6}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child, .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker, .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{color:var(--rebecca)}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   .instruction-header[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   .instruction-header[_ngcontent-%COMP%]{font-size:clamp(1.25rem,1vw,1.3rem);margin-bottom:32px}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:8px}.instructions-panel[_ngcontent-%COMP%]   .tips-section[_ngcontent-%COMP%]{margin-top:32px;border-top:1px solid rgba(102,51,153,.3)}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}@media (max-width: 1024px){.instructions-panel[_ngcontent-%COMP%]{border-left:none;border-top:1px solid rgba(102,51,153,.4)}}@media (max-width: 768px){.note-tutor-container[_ngcontent-%COMP%]{gap:0}.game-header[_ngcontent-%COMP%]{padding:16px}.progress-section[_ngcontent-%COMP%]{padding:10px}.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{gap:40px}.progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{gap:45px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem}.progress-section[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{max-height:80vh}.game-area[_ngcontent-%COMP%]{padding:40px 24px;gap:24px}.staff-section[_ngcontent-%COMP%]{padding:6px;min-height:200px}.controls[_ngcontent-%COMP%]{width:100%}.controls[_ngcontent-%COMP%]   .next-note[_ngcontent-%COMP%]{width:100%;padding:24px 32px}.controls[_ngcontent-%COMP%]   .next-note-enabled[_ngcontent-%COMP%]{padding:38px 32px;margin:24px 0}.instructions-panel[_ngcontent-%COMP%]{padding:32px 20px}}@media (max-width: 480px){.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{gap:32px;grid-template-columns:1fr 1fr}.progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{gap:15px}.progress-section[_ngcontent-%COMP%]   .stat-line.options-stat-line[_ngcontent-%COMP%]{justify-content:space-around}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{position:fixed;left:50%;top:auto;transform:translate(-50%);min-width:85vw;max-width:90vw;z-index:2000;margin-top:15px;max-height:45vh}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.level-badge[_ngcontent-%COMP%]{font-size:1.2rem}.game-area[_ngcontent-%COMP%]{padding:24px 12px;gap:12px}.game-area[_ngcontent-%COMP%]   .instruction-text[_ngcontent-%COMP%]{font-size:1.7rem}.controls[_ngcontent-%COMP%]{flex-direction:column;width:100%}.controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.controls[_ngcontent-%COMP%]   .btn.next-note-enabled[_ngcontent-%COMP%]{padding:32px}.feedback[_ngcontent-%COMP%]   .feedback-message[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:900}}@media (prefers-contrast: high){.game-header[_ngcontent-%COMP%], .progress-section[_ngcontent-%COMP%], .game-area[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]{border:2px solid var(--white)}.feedback.success[_ngcontent-%COMP%], .feedback.error[_ngcontent-%COMP%]{border-width:2px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}.loading-spinner[_ngcontent-%COMP%]{animation:none;border-top-color:var(--fuchsia)}}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#00000080;z-index:500;overflow:hidden}']})};export{$e as NoteTutor};
