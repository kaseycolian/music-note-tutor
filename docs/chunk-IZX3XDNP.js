import{$a as Se,Ab as Be,Bb as j,Ca as V,Da as Me,Fb as He,Ha as Pe,Ia as m,Ja as b,Ka as C,L as E,La as we,Ma as F,Na as R,Oa as U,P as v,Pa as c,Qa as a,Ra as re,S as fe,Sa as _,Ta as h,U as M,Ua as q,V as P,Va as k,W as $,Wa as Oe,X as ge,Xa as N,Y,Ya as Ne,Z as pe,Za as d,_a as Ee,a as S,ab as Ae,b as A,bb as ke,c as oe,ca as g,cb as G,db as Q,ea as me,eb as r,fb as w,ga as he,gb as D,hb as De,ib as Te,jb as Ie,ka as _e,kb as Fe,na as be,oa as ie,ob as O,pa as l,pb as Z,qb as Re,rb as I,ua as Ce,ub as se,va as ve,vb as Le,xa as xe,ya as ye}from"./chunk-XO7W5FNY.js";function Ve(){let o=typeof document<"u"&&document?document.activeElement:null;for(;o&&o.shadowRoot;){let t=o.shadowRoot.activeElement;if(t===o)break;o=t}return o}var ae;try{ae=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ae=!1}var ce=(()=>{class o{_platformId=v(_e);isBrowser=this._platformId?He(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||ae)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var X=new WeakMap,$e=(()=>{class o{_appRef;_injector=v(Y);_environmentInjector=v(fe);load(e){let n=this._appRef=this._appRef||this._injector.get(Pe),i=X.get(n);i||(i={loaders:new Set,refs:[]},X.set(n,i),n.onDestroy(()=>{X.get(n)?.refs.forEach(s=>s.destroy()),X.delete(n)})),i.loaders.has(e)||(i.loaders.add(e),i.refs.push(Le(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Ge=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275cmp=V({type:o,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(n,i){},styles:[`.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}
`],encapsulation:2,changeDetection:0})}return o})();var Je=(()=>{class o{_platform=v(ce);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return tt(e)&&getComputedStyle(e).visibility==="visible"}isTabbable(e){if(!this._platform.isBrowser)return!1;let n=et(lt(e));if(n&&(We(n)===-1||!this.isVisible(n)))return!1;let i=e.nodeName.toLowerCase(),s=We(e);return e.hasAttribute("contenteditable")?s!==-1:i==="iframe"||i==="object"||this._platform.WEBKIT&&this._platform.IOS&&!at(e)?!1:i==="audio"?e.hasAttribute("controls")?s!==-1:!1:i==="video"?s===-1?!1:s!==null?!0:this._platform.FIREFOX||e.hasAttribute("controls"):e.tabIndex>=0}isFocusable(e,n){return ct(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(n){return new(n||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function et(o){try{return o.frameElement}catch{return null}}function tt(o){return!!(o.offsetWidth||o.offsetHeight||typeof o.getClientRects=="function"&&o.getClientRects().length)}function nt(o){let t=o.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function ot(o){return rt(o)&&o.type=="hidden"}function it(o){return st(o)&&o.hasAttribute("href")}function rt(o){return o.nodeName.toLowerCase()=="input"}function st(o){return o.nodeName.toLowerCase()=="a"}function je(o){if(!o.hasAttribute("tabindex")||o.tabIndex===void 0)return!1;let t=o.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function We(o){if(!je(o))return null;let t=parseInt(o.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function at(o){let t=o.nodeName.toLowerCase(),e=t==="input"&&o.type;return e==="text"||e==="password"||t==="select"||t==="textarea"}function ct(o){return ot(o)?!1:nt(o)||it(o)||o.hasAttribute("contenteditable")||je(o)}function lt(o){return o.ownerDocument&&o.ownerDocument.defaultView||window}var le=class{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_enabled=!0;constructor(t,e,n,i,s=!1,u){this._element=t,this._checker=e,this._ngZone=n,this._document=i,this._injector=u,s||this.attachAnchors()}destroy(){let t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){let n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){let e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=0;n<e.length;n++){let i=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(i)return i}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children;for(let n=e.length-1;n>=0;n--){let i=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(i)return i}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._injector?ve(t,{injector:this._injector}):setTimeout(t)}},ze=(()=>{class o{_checker=v(Je);_ngZone=v(Ce);_document=v(pe);_injector=v(Y);constructor(){v($e).load(Ge)}create(e,n=!1){return new le(e,this._checker,this._ngZone,this._document,n,this._injector)}static \u0275fac=function(n){return new(n||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),de=(()=>{class o{_elementRef=v(he);_focusTrapFactory=v(ze);focusTrap;_previouslyFocusedElement=null;get enabled(){return this.focusTrap?.enabled||!1}set enabled(e){this.focusTrap&&(this.focusTrap.enabled=e)}autoCapture;constructor(){v(ce).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(e){let n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Ve(),this.focusTrap?.focusInitialElementWhenReady()}static \u0275fac=function(n){return new(n||o)};static \u0275dir=Me({type:o,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",se],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",se]},exportAs:["cdkTrapFocus"],features:[me]})}return o})();var Ke=[{mode:"default",label:"Default",description:"All note positions for treble and bass clefs"},{mode:"easy",label:"Easy",description:"Only notes on the staff lines and spaces"},{mode:"hard",label:"Hard",description:"Only notes on ledger lines above and below staff"}],Ue=[{filter:"both",label:"Both",description:"Show notes from both treble and bass clefs"},{filter:"treble",label:"Treble",description:"Show only treble clef notes"},{filter:"bass",label:"Bass",description:"Show only bass clef notes"}],Ye=[{filter:"all",label:"All",description:"Practice all notes"},{filter:"C",label:"C",description:"Practice only C notes"},{filter:"D",label:"D",description:"Practice only D notes"},{filter:"E",label:"E",description:"Practice only E notes"},{filter:"F",label:"F",description:"Practice only F notes"},{filter:"G",label:"G",description:"Practice only G notes"},{filter:"A",label:"A",description:"Practice only A notes"},{filter:"B",label:"B",description:"Practice only B notes"}],ue={treble:{easy:["E4","F4","G4","A4","B4","C5","D5","E5","F5"],hard:["C4","D4","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7"],default:["C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7"]},bass:{easy:["G2","A2","B2","C3","D3","E3","F3","G3","A3"],hard:["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","B3","C4","D4","E4","F4","G4","A4","B4","C5"],default:["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5"]}};var J=class o{levelConfigurations=new Map;constructor(){this.initializeLevelConfigurations()}getLevelConfiguration(t){let e=this.levelConfigurations.get(t);if(!e)throw new Error(`No configuration found for level: ${t}`);return e}getAvailableLevels(){return Array.from(this.levelConfigurations.keys())}getNextLevel(t){let e=["easy","hard","mixed"],n=e.indexOf(t);return n>=0&&n<e.length-1?e[n+1]:null}canUnlockLevel(t,e,n){let i=this.getLevelConfiguration(t);return e>=i.progressionCriteria.minAccuracy&&n>=i.progressionCriteria.minQuestions}getBaseWeights(t){let e=this.getLevelConfiguration(t);return new Map(e.baseWeights)}updateBaseWeights(t,e){let n=this.levelConfigurations.get(t);if(n){let i=A(S({},n),{baseWeights:new Map(e)});this.levelConfigurations.set(t,i)}}initializeLevelConfigurations(){this.levelConfigurations.set("easy",this.createEasyConfig()),this.levelConfigurations.set("hard",this.createHardConfig()),this.levelConfigurations.set("mixed",this.createMixedConfig())}createEasyConfig(){let t={trebleRange:{min:4,max:6},bassRange:{min:2,max:4},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!1},e={trebleWeight:.7,bassWeight:.3},n={minAccuracy:.78,minQuestions:35,consecutiveCorrect:7},i=this.generateBaseWeights(t,1);return{level:"easy",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}createHardConfig(){let t={trebleRange:{min:3,max:7},bassRange:{min:1,max:5},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!0},e={trebleWeight:.5,bassWeight:.5},n={minAccuracy:.88,minQuestions:150,consecutiveCorrect:12},i=this.generateBaseWeights(t,1);return{level:"hard",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}createMixedConfig(){let t={trebleRange:{min:3,max:7},bassRange:{min:1,max:5},allowedNotes:["C","D","E","F","G","A","B"],includeAccidentals:!0},e={trebleWeight:.5,bassWeight:.5},n={minAccuracy:.83,minQuestions:100,consecutiveCorrect:10},i=this.generateBaseWeights(t,1);return{level:"mixed",noteRange:t,clefDistribution:e,baseWeights:i,progressionCriteria:n}}generateBaseWeights(t,e){let n=new Map;return["treble","bass"].forEach(s=>{let u=s==="treble"?t.trebleRange:t.bassRange;for(let p=u.min;p<=u.max;p++)t.allowedNotes.forEach(x=>{let f=`${x}${p}-${s}`;n.set(f,e),t.includeAccidentals&&(n.set(`${f}-sharp`,e*.8),n.set(`${f}-flat`,e*.8))})}),n}getNotePriorities(t){return{easy:{"C4-treble":1.4,"D4-treble":1.3,"E4-treble":1.3,"F4-treble":1.2,"G4-treble":1.2,"A4-treble":1.2,"B4-treble":1.2,"C5-treble":1.1,"C3-bass":1.3,"D3-bass":1.2,"E3-bass":1.2},hard:{"C6-treble":1.1,"C7-treble":1,"B2-bass":1.1,"C1-bass":1,"F4-treble-sharp":1,"B4-treble-flat":1,"F3-bass-sharp":1,"A5-treble-flat":1}}[t]||{}}getAdaptiveWeightingParams(t){return{easy:{performanceWeight:.45,recencyWeight:.28,difficultyWeight:.17,randomnessWeight:.1},hard:{performanceWeight:.65,recencyWeight:.18,difficultyWeight:.1,randomnessWeight:.07},mixed:{performanceWeight:.55,recencyWeight:.23,difficultyWeight:.13,randomnessWeight:.09}}[t]}static \u0275fac=function(e){return new(e||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var z=class o{save(t,e){try{let n=JSON.stringify(e);localStorage.setItem(t,n)}catch(n){console.error(`Failed to save data to localStorage for key: ${t}`,n)}}load(t){try{let e=localStorage.getItem(t);return e===null?null:JSON.parse(e)}catch(e){return console.error(`Failed to load data from localStorage for key: ${t}`,e),null}}clear(t){try{localStorage.removeItem(t)}catch(e){console.error(`Failed to clear data from localStorage for key: ${t}`,e)}}exists(t){return localStorage.getItem(t)!==null}getKeysWithPrefix(t){let e=[];for(let n=0;n<localStorage.length;n++){let i=localStorage.key(n);i&&i.startsWith(t)&&e.push(i)}return e}clearAll(){try{localStorage.clear()}catch(t){console.error("Failed to clear all localStorage data",t)}}getStorageSize(){let t=0;for(let e in localStorage)localStorage.hasOwnProperty(e)&&(t+=localStorage[e].length+e.length);return t}static \u0275fac=function(e){return new(e||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var K=class o{storageService=v(z);userProgress=g(this.getDefaultProgress());currentSession=g(null);currentLevel=O(()=>this.userProgress().currentLevel);overallAccuracy=O(()=>this.userProgress().overallAccuracy);totalQuestions=O(()=>this.userProgress().totalQuestionsAnswered);sessionDuration=O(()=>{let t=this.currentSession();return!t||!t.endTime?0:t.endTime.getTime()-t.startTime.getTime()});constructor(){this.loadProgress(),this.startNewSession()}getCurrentProgress(){return this.userProgress()}updateLevel(t){let e=this.userProgress();if(e.levelProgression.find(i=>i.level===t)){let i=A(S({},e),{currentLevel:t});this.userProgress.set(i),this.saveProgress()}else{let i={level:t,unlockedAt:new Date,questionsAtLevel:0,accuracyAtLevel:0},s=A(S({},e),{currentLevel:t,levelProgression:[...e.levelProgression,i]});this.userProgress.set(s),this.saveProgress()}}recordQuestionAttempt(t,e){let n=this.userProgress(),i=this.currentSession(),s=n.totalQuestionsAnswered+1,p=Math.round(n.overallAccuracy*n.totalQuestionsAnswered)+(t?1:0),x=s>0?p/s:0,f=n.levelProgression.map(y=>{if(y.level===n.currentLevel){let T=y.questionsAtLevel+1,H=Math.round(y.accuracyAtLevel*y.questionsAtLevel)+(t?1:0),Xe=T>0?H/T:0;return A(S({},y),{questionsAtLevel:T,accuracyAtLevel:Xe})}return y}),B=A(S({},n),{totalQuestionsAnswered:s,overallAccuracy:x,levelProgression:f});if(this.userProgress.set(B),i){let y=A(S({},i),{questionsAnswered:i.questionsAnswered+1,correctAnswers:i.correctAnswers+(t?1:0),averageResponseTime:this.calculateNewAverageResponseTime(i.averageResponseTime,i.questionsAnswered,e)});this.currentSession.set(y),this.saveSession(y)}this.saveProgress()}startNewSession(){let e={sessionId:this.generateSessionId(),startTime:new Date,questionsAnswered:0,correctAnswers:0,averageResponseTime:0,notesEncountered:[]};this.currentSession.set(e),this.saveSession(e)}endCurrentSession(){let t=this.currentSession();if(t){let e=A(S({},t),{endTime:new Date});this.currentSession.set(e),this.saveSession(e)}}getSessionStats(){let t=this.currentSession();if(!t)return{questionsAnswered:0,accuracy:0,averageResponseTime:0,duration:0};let e=t.questionsAnswered>0?t.correctAnswers/t.questionsAnswered:0,n=t.endTime?t.endTime.getTime()-t.startTime.getTime():Date.now()-t.startTime.getTime();return{questionsAnswered:t.questionsAnswered,accuracy:e,averageResponseTime:t.averageResponseTime,duration:n}}resetProgress(){let t=this.getDefaultProgress();this.userProgress.set(t),this.currentSession.set(null),this.storageService.clear("user-progress"),this.storageService.clear("current-session"),this.startNewSession()}exportProgress(){return JSON.stringify({progress:this.userProgress(),session:this.currentSession()},null,2)}importProgress(t){try{let e=JSON.parse(t);return e.progress&&(this.userProgress.set(e.progress),this.saveProgress()),e.session&&(this.currentSession.set(e.session),this.saveSession(e.session)),!0}catch(e){return console.error("Failed to import progress data:",e),!1}}getDefaultProgress(){return{currentLevel:"easy",totalQuestionsAnswered:0,overallAccuracy:0,sessionStartTime:new Date,levelProgression:[{level:"easy",unlockedAt:new Date,questionsAtLevel:0,accuracyAtLevel:0}]}}calculateNewAverageResponseTime(t,e,n){return e===0?n:(t*e+n)/(e+1)}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}saveProgress(){this.storageService.save("user-progress",this.userProgress())}loadProgress(){let t=this.storageService.load("user-progress");if(t){let e=A(S({},t),{sessionStartTime:new Date(t.sessionStartTime),levelProgression:t.levelProgression.map(n=>A(S({},n),{unlockedAt:new Date(n.unlockedAt)}))});this.userProgress.set(e)}}saveSession(t){this.storageService.save("current-session",t)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var ee=class o{performanceData=g(new Map);currentLevel=g("easy");recentHistory=g([]);difficultyMode=g("default");clefFilter=g("both");noteFilter=g("all");overallAccuracy=O(()=>{let t=Array.from(this.performanceData().values());if(t.length===0)return 0;let e=t.reduce((i,s)=>i+s.correctAnswers,0),n=t.reduce((i,s)=>i+s.attempts,0);return n>0?e/n:0});configService=v(J);progressService=v(K);storageService=v(z);constructor(){Z(()=>{this.persistPerformanceData()}),this.loadPerformanceData()}generateNextNote(t){let e=this.buildSelectionContext(t),n=this.buildCandidatePool(e),i=this.calculateWeights(n,e),s=this.performWeightedSelection(i);return this.updateHistory(s),s}recordAnswer(t,e,n,i){this.updatePerformanceData(t,n,i),this.checkLevelProgression()}getCurrentLevelConfig(){return this.configService.getLevelConfiguration(this.currentLevel())}getPerformanceStats(){return new Map(this.performanceData())}resetProgress(){this.performanceData.set(new Map),this.recentHistory.set([]),this.currentLevel.set("easy"),this.storageService.clear("performance-data"),this.storageService.clear("recent-history"),this.storageService.clear("current-level")}setDifficultyMode(t){this.difficultyMode.set(t)}getDifficultyMode(){return this.difficultyMode()}setClefFilter(t){this.clefFilter.set(t)}getClefFilter(){return this.clefFilter()}setNoteFilter(t){this.noteFilter.set(t)}getNoteFilter(){return this.noteFilter()}buildSelectionContext(t){let e=this.progressService.getCurrentProgress();return{currentLevel:t?.currentLevel??this.currentLevel(),userProgress:t?.userProgress??e,performanceMap:t?.performanceMap??this.performanceData(),recentHistory:t?.recentHistory??this.recentHistory(),sessionContext:t?.sessionContext??{sessionStartTime:e.sessionStartTime,questionsThisSession:e.totalQuestionsAnswered,accuracyThisSession:e.overallAccuracy}}}buildCandidatePool(t){let e=this.getCurrentLevelConfig(),n=[];["treble","bass"].forEach(f=>{let B=f==="treble"?e.noteRange.trebleRange:e.noteRange.bassRange;for(let y=B.min;y<=B.max;y++)e.noteRange.allowedNotes.forEach(T=>{let W=`${T}${y}-${f}`,H=this.determineStaffPosition(T,y,f);n.push({name:T,octave:y,clef:f,position:H,id:W}),e.noteRange.includeAccidentals&&(n.push({name:T,octave:y,clef:f,accidental:"sharp",position:H,id:`${W}-sharp`}),n.push({name:T,octave:y,clef:f,accidental:"flat",position:H,id:`${W}-flat`}))})});let s=n,u=this.difficultyMode();u!=="default"&&(s=s.filter(f=>{let B=`${f.name}${f.octave}`;return(f.clef==="treble"?ue.treble:ue.bass)[u].includes(B)}));let p=this.clefFilter();p!=="both"&&(s=s.filter(f=>f.clef===p));let x=this.noteFilter();return x!=="all"&&(s=s.filter(f=>f.name===x)),s}calculateWeights(t,e){let n=this.getCurrentLevelConfig();return t.map(i=>{let s=n.baseWeights.get(i.id)??1,u=e.performanceMap.get(i.id);if(u){let f=1-u.accuracy;s*=1+f*2,u.consecutiveIncorrect>0&&(s*=1+u.consecutiveIncorrect*.5),u.consecutiveCorrect>3&&(s*=.7)}else s*=1.3;let p=e.recentHistory.findIndex(f=>f.id===i.id);if(p!==-1){let f=Math.max(.1,1-(p+1)*.3);s*=f}let x=i.clef==="treble"?n.clefDistribution.trebleWeight:n.clefDistribution.bassWeight;return s*=x,A(S({},i),{weight:Math.max(.01,s)})})}performWeightedSelection(t){let e=t.reduce((x,f)=>x+f.weight,0),n=Math.random()*e;for(let x of t)if(n-=x.weight,n<=0){let u=x,{weight:f}=u;return oe(u,["weight"])}let p=t[t.length-1],{weight:i}=p;return oe(p,["weight"])}updatePerformanceData(t,e,n){let i=this.performanceData(),s=i.get(t.id),u=(s?.attempts??0)+1,p=(s?.correctAnswers??0)+(e?1:0),x=p/u,f=s?(s.averageResponseTime*s.attempts+n)/u:n,B=e?(s?.consecutiveCorrect??0)+1:0,y=e?0:(s?.consecutiveIncorrect??0)+1,T=Math.round((1-x)*100),W={noteId:t.id,attempts:u,correctAnswers:p,accuracy:x,lastSeen:new Date,averageResponseTime:f,consecutiveCorrect:B,consecutiveIncorrect:y,difficultyScore:T},H=new Map(i);H.set(t.id,W),this.performanceData.set(H)}updateHistory(t){let e=this.recentHistory(),i=[t,...e.slice(0,10-1)];this.recentHistory.set(i)}checkLevelProgression(){let t=this.getCurrentLevelConfig(),e=this.progressService.getCurrentProgress(),n=e.overallAccuracy>=t.progressionCriteria.minAccuracy,i=e.totalQuestionsAnswered>=t.progressionCriteria.minQuestions,u=this.countRecentCorrectAnswers()>=t.progressionCriteria.consecutiveCorrect;n&&i&&u&&this.advanceLevel()}countRecentCorrectAnswers(){return 0}advanceLevel(){let t=this.currentLevel(),e=["easy","hard"],n=e.indexOf(t);if(n<e.length-1){let i=e[n+1];this.currentLevel.set(i),this.progressService.updateLevel(i)}}determineStaffPosition(t,e,n){let i=`${t}${e}`;if(n==="treble"){let s=["E4","G4","B4","D5","F5"],u=["F4","A4","C5","E5"];if(s.includes(i))return"line";if(u.includes(i))return"space";if(e<4||e===4&&["C","D"].includes(t))return"ledger-below";if(e>5||e===5&&["G","A","B"].includes(t)||e>=6)return"ledger-above"}else{let s=["G2","B2","D3","F3","A3"],u=["A2","C3","E3","G3"];if(s.includes(i))return"line";if(u.includes(i))return"space";if(e<2||e===2&&["E","F"].includes(t))return"ledger-below";if(e>3||e===3&&["B"].includes(t)||e>=4)return"ledger-above"}return"space"}persistPerformanceData(){this.storageService.save("performance-data",Array.from(this.performanceData().entries())),this.storageService.save("recent-history",this.recentHistory()),this.storageService.save("current-level",this.currentLevel())}loadPerformanceData(){let t=this.storageService.load("performance-data");t&&this.performanceData.set(new Map(t));let e=this.storageService.load("recent-history");e&&this.recentHistory.set(e);let n=this.storageService.load("current-level");n&&this.currentLevel.set(n)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"})};var dt=(o,t)=>t.y;function ut(o,t){if(o&1&&($(),q(0,"line",2)),o&2){let e=t.$implicit,n=d();m("y1",e)("x2",n.staffWidth-50)("y2",e)}}function ft(o,t){if(o&1&&($(),q(0,"line",7)),o&2){let e=t.$implicit;m("x1",e.x1)("y1",e.y)("x2",e.x2)("y2",e.y)}}function gt(o,t){if(o&1&&F(0,ft,1,4,":svg:line",7,dt),o&2){let e=d();R(e.ledgerLines())}}function pt(o,t){if(o&1&&($(),_(0,"text",8),r(1),h()),o&2){let e=t,n=d(2);m("x",e.x)("y",e.y+6),l(),D(" ",n.getAccidentalSymbol(n.currentNote().accidental)," ")}}function mt(o,t){if(o&1&&(b(0,pt,2,3,":svg:text",8),$(),_(1,"g"),q(2,"ellipse",9),h()),o&2){let e,n=t,i=d();C((e=i.shouldShowAccidental()&&i.getAccidentalPosition())?0:-1,e),l(),m("transform","translate("+n.x+","+n.y+") rotate(20) scale(1.2, 1.1)"),l(),Q(i.getNoteClasses().join(" ")),m("rx",i.noteRadius)("ry",i.noteRadius*.7)("aria-label","Note: "+i.currentNote().name+(i.currentNote().accidental?" "+i.currentNote().accidental:"")+" octave "+i.currentNote().octave)}}function ht(o,t){if(o&1&&($(),_(0,"text",4),r(1,' Click "New Note" to start '),h()),o&2){let e=d();m("x",e.staffCenterX)("y",e.staffCenterY)}}function _t(o,t){if(o&1&&r(0),o&2){let e=t,n=d();Te(" Musical staff in ",n.clef()," clef showing ",e.name,"",e.accidental?" "+e.accidental:""," in octave ",e.octave,". ")}}function bt(o,t){if(o&1&&r(0),o&2){let e=d();D(" Musical staff in ",e.clef()," clef with no note displayed. ")}}function Ct(o,t){if(o&1&&(_(0,"span",11),r(1),h()),o&2){let e=d(),n=d();l(),w(n.getAccidentalSymbol(e.accidental))}}function vt(o,t){if(o&1&&(_(0,"div",6)(1,"span",10),r(2),h(),b(3,Ct,2,1,"span",11),_(4,"span",12),r(5),h()()),o&2){let e=t;l(2),w(e.name),l(),C(e.accidental?3:-1),l(2),w(e.octave)}}var te=class o{currentNote=I(null);showNote=I(!0);showResult=I(!1);clef=I("treble");highlightNote=I(!1);staffLines=g([]);notePosition=g(null);staffHeight=250;staffWidth=400;lineSpacing=15;noteRadius=7;staffCenterY=125;staffCenterX=200;staffLinePositions=O(()=>{let t=this.lineSpacing,e=this.staffCenterY;return[e-t*2,e-t,e,e+t,e+t*2]});clefSymbol=O(()=>this.clef()==="treble"?"\u{1D11E}":"\u{1D122}");noteDisplayPosition=O(()=>{let t=this.currentNote();return!t||!this.showNote()?null:this.calculateNotePosition(t)});ledgerLines=O(()=>{let t=this.currentNote();return!t||!this.showNote()?[]:this.calculateLedgerLines(t)});constructor(){Z(()=>{this.updateStaffForClef()})}calculateNotePosition(t){let e=this.staffLinePositions(),n=this.lineSpacing,s=this.staffCenterY;return t.clef==="treble"?s=this.calculateTreblePosition(t,e,n):s=this.calculateBassPosition(t,e,n),{x:this.staffCenterX,y:s}}calculateTreblePosition(t,e,n){let i=`${t.name}${t.octave}`;return{C4:e[4]+n,D4:e[4]+n/2,E4:e[4],F4:e[4]-n/2,G4:e[3],A4:e[3]-n/2,B4:e[2],C5:e[2]-n/2,D5:e[1],E5:e[1]-n/2,F5:e[0],G5:e[0]-n/2,A5:e[0]-n,B5:e[0]-n*1.5,C6:e[0]-n*2,D6:e[0]-n*2.5,E6:e[0]-n*3,F6:e[0]-n*3.5,G6:e[0]-n*4,A6:e[0]-n*4.5,B6:e[0]-n*5,C7:e[0]-n*5.5}[i]??e[2]}calculateBassPosition(t,e,n){let i=`${t.name}${t.octave}`;return{C1:e[4]+n*3,D1:e[4]+n*2.5,E1:e[4]+n*2,F1:e[4]+n*1.5,G1:e[4]+n,A1:e[4]+n*.5,B1:e[4],C2:e[4]+n*1.5,D2:e[4]+n,E2:e[4]+n*.5,F2:e[4]+n/2,G2:e[4],A2:e[4]-n/2,B2:e[3],C3:e[3]-n/2,D3:e[2],E3:e[2]-n/2,F3:e[1],G3:e[1]-n/2,A3:e[0],B3:e[0]-n/2,C4:e[0]-n,D4:e[0]-n*1.5,E4:e[0]-n*2,F4:e[0]-n*2.5,G4:e[0]-n*3,A4:e[0]-n*3.5,B4:e[0]-n*4,C5:e[0]-n*4.5}[i]??e[2]}calculateLedgerLines(t){let e=this.calculateNotePosition(t),n=this.staffLinePositions(),i=this.lineSpacing,s=[],u=e.y,p=n[0],x=n[4];if(u<p){let f=p-i;for(;f>=u-i/2;)s.push({y:f,x1:e.x-25,x2:e.x+25}),f-=i}if(u>x){let f=x+i;for(;f<=u+i/2;)s.push({y:f,x1:e.x-25,x2:e.x+25}),f+=i}return s}updateStaffForClef(){let t=[0,1,2,3,4];this.staffLines.set(t)}getNoteClasses(){let t=["note"];this.highlightNote()&&t.push("highlighted");let e=this.currentNote();return e?.accidental&&t.push(`accidental-${e.accidental}`),t}getAccidentalSymbol(t){return{sharp:"\u266F",flat:"\u266D"}[t]||""}shouldShowAccidental(){return!!(this.currentNote()?.accidental&&this.showNote())}getAccidentalPosition(){let t=this.noteDisplayPosition();return!t||!this.shouldShowAccidental()?null:{x:t.x-20,y:t.y}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-musical-staff"]],inputs:{currentNote:[1,"currentNote"],showNote:[1,"showNote"],showResult:[1,"showResult"],clef:[1,"clef"],highlightNote:[1,"highlightNote"]},decls:13,vars:11,consts:[[1,"musical-staff-container"],["preserveAspectRatio","xMidYMid slice","role","img",1,"staff-svg"],["x1","50","stroke","#000","stroke-width","2",1,"staff-line"],["x","90","font-family","serif","fill","#000","text-anchor","middle",1,"clef-symbol"],["font-family","Arial, sans-serif","font-size","16","fill","#666","text-anchor","middle",1,"placeholder-text"],["id","staff-description",1,"sr-only"],["role","status","aria-live","polite",1,"note-info"],["stroke","#000","stroke-width","2",1,"ledger-line"],["font-family","serif","font-size","20","fill","#000","text-anchor","middle",1,"accidental"],["cx","0","cy","0","fill","none","stroke","#000","stroke-width","3.5"],[1,"note-name"],[1,"note-accidental"],[1,"note-octave"]],template:function(e,n){if(e&1&&(_(0,"div",0),$(),_(1,"svg",1),F(2,ut,1,3,":svg:line",2,we),_(4,"text",3),r(5),h(),b(6,gt,2,0),b(7,mt,3,7),b(8,ht,2,2,":svg:text",4),h(),ge(),_(9,"div",5),b(10,_t,1,4)(11,bt,1,1),h(),b(12,vt,6,3,"div",6),h()),e&2){let i,s,u,p,x;m("aria-label","Musical staff displaying "+(((i=n.currentNote())==null?null:i.name)||"no note")),l(),m("viewBox","0 0 "+n.staffWidth+" "+n.staffHeight)("aria-describedby","staff-description"),l(),R(n.staffLinePositions()),l(2),m("y",n.clef()==="bass"?n.staffCenterY+28:n.staffCenterY+15)("font-size",n.clef()==="bass"?"70":"85"),l(),D(" ",n.clefSymbol()," "),l(),C((s=n.showNote()&&n.currentNote())?6:-1,s),l(),C((u=n.showNote()&&n.noteDisplayPosition())?7:-1,u),l(),C(!n.showNote()||!n.currentNote()?8:-1),l(2),C((p=n.currentNote())?10:11,p),l(2),C((x=n.showResult()&&n.currentNote())?12:-1,x)}},dependencies:[j],styles:[".musical-staff-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;background:#1a0035cc;border-radius:0;box-shadow:0 0 40px #ff00aa26;margin:0;border:1px solid rgba(102,51,153,.4);clip-path:polygon(12px 0,100% 0,calc(100% - 12px) 100%,0 100%);width:100%}.musical-staff-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:.75rem;letter-spacing:.15em;text-transform:uppercase;color:var(--electric-mint);margin-bottom:16px;font-weight:700;text-align:center}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{background:#1a003599;border:1px solid rgba(102,51,153,.3);border-radius:0;padding:20px;transition:all .3s ease;display:block;margin:0 auto;width:100%;max-width:600px;height:auto}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]:hover{box-shadow:0 0 30px #f0a3;border-color:#f0a6}.musical-staff-container[_ngcontent-%COMP%]   .staff-line[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .ledger-line[_ngcontent-%COMP%]{stroke:var(--white)}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%]{font-family:Times New Roman,serif;font-weight:700;fill:var(--fuchsia);filter:drop-shadow(0 0 4px rgba(255,0,170,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--fuchsia);stroke-width:3.5;transition:all .2s ease;filter:drop-shadow(0 0 6px rgba(255,0,170,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note.highlighted[_ngcontent-%COMP%]{fill:none;stroke:var(--electric-mint);stroke-width:4;filter:drop-shadow(0 0 12px rgba(0,255,204,.8));animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.musical-staff-container[_ngcontent-%COMP%]   .note.accidental-sharp[_ngcontent-%COMP%]{stroke:#8e44ad;filter:drop-shadow(0 0 6px rgba(142,68,173,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note.accidental-flat[_ngcontent-%COMP%]{stroke:#16a085;filter:drop-shadow(0 0 6px rgba(22,160,133,.6))}.musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%]{stroke:var(--fuchsia);stroke-width:2;transition:all .2s ease;filter:drop-shadow(0 0 4px rgba(255,0,170,.4))}.musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{font-family:Times New Roman,serif;font-weight:700;fill:var(--pale-lavender);filter:drop-shadow(0 0 3px rgba(232,204,255,.4))}.musical-staff-container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;fill:#e8ccff4d;font-style:italic;font-size:14px;letter-spacing:.1em}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-top:20px;padding:12px 24px;background:#ff00aa1a;border:1px solid var(--fuchsia);border-radius:0;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%);font-family:Courier New,Courier,monospace;font-weight:700;color:var(--white);box-shadow:0 0 20px #f0a3;transition:all .3s ease}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 0 30px #f0a6}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{font-size:24px;font-weight:900;color:var(--fuchsia);text-shadow:0 0 10px rgba(255,0,170,.8)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-accidental[_ngcontent-%COMP%]{font-size:20px;color:var(--electric-mint);margin:0 4px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{font-size:18px;color:var(--pale-lavender);background:#6633994d;padding:2px 10px;border:1px solid var(--rebecca);clip-path:polygon(4px 0,100% 0,calc(100% - 4px) 100%,0 100%)}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}@media (max-width: 768px){.musical-staff-container[_ngcontent-%COMP%]{padding:16px}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{width:100%;max-width:none;height:auto;padding:15px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{padding:10px 20px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{font-size:20px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-accidental[_ngcontent-%COMP%]{font-size:16px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){.musical-staff-container[_ngcontent-%COMP%]{padding:12px}.musical-staff-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:12px}.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{width:100%;max-width:none;padding:4px}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{flex-direction:column;gap:6px;text-align:center}}@media (prefers-contrast: high){.musical-staff-container[_ngcontent-%COMP%]   .staff-line[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .ledger-line[_ngcontent-%COMP%]{stroke:var(--white);stroke-width:2}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--white);stroke-width:3.5}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{fill:var(--white)}}@media (prefers-reduced-motion: reduce){.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{transition:none}.musical-staff-container[_ngcontent-%COMP%]   .note.highlighted[_ngcontent-%COMP%]{animation:none}}@media (prefers-color-scheme: dark){.musical-staff-container[_ngcontent-%COMP%]   .staff-svg[_ngcontent-%COMP%]{background:#1a0035cc;background:#0d0020cc;border-color:#66339980}.musical-staff-container[_ngcontent-%COMP%]   .clef-symbol[_ngcontent-%COMP%], .musical-staff-container[_ngcontent-%COMP%]   .accidental[_ngcontent-%COMP%]{fill:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{fill:none;stroke:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note-stem[_ngcontent-%COMP%]{stroke:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{fill:#e8ccff4d}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]{background:#ff00aa26;border-color:var(--fuchsia);color:var(--white)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-name[_ngcontent-%COMP%]{color:var(--fuchsia)}.musical-staff-container[_ngcontent-%COMP%]   .note-info[_ngcontent-%COMP%]   .note-octave[_ngcontent-%COMP%]{background:#6396;color:var(--pale-lavender)}}.musical-staff-container[_ngcontent-%COMP%]:focus-within{outline:2px solid var(--fuchsia);outline-offset:4px}"]})};var xt=(o,t)=>t.note,yt=(o,t)=>t.key;function Mt(o,t){o&1&&(_(0,"span",15),r(1),h()),o&2&&(l(),w(t))}function Pt(o,t){o&1&&(_(0,"span",16),r(1,"\u2713"),h())}function wt(o,t){if(o&1){let e=k();_(0,"button",13),Ne("click",function(){let i=M(e).$implicit,s=d();return P(s.onNoteClick(i.note))})("mouseenter",function(){let i=M(e).$implicit,s=d();return P(s.onNoteHover(i.note))})("mouseleave",function(){M(e);let i=d();return P(i.onNoteHover(null))})("focus",function(){let i=M(e).$implicit,s=d();return P(s.onNoteHover(i.note))})("blur",function(){M(e);let i=d();return P(i.onNoteHover(null))}),_(1,"span",14),r(2),h(),b(3,Mt,2,1,"span",15),b(4,Pt,2,0,"span",16),h()}if(o&2){let e,n=t.$implicit,i=d();Q(i.getNoteButtonClasses(n.note).join(" ")),ke("--note-color",i.getNoteColor(n.note)),Oe("disabled",i.disabled()),m("aria-label",i.getAriaLabel(n.note))("aria-pressed",i.isNoteSelected(n.note)),l(2),w(n.label),l(),C((e=i.getKeyboardShortcut(n.note))?3:-1,e),l(),C(i.isNoteSelected(n.note)?4:-1)}}function Ot(o,t){if(o&1&&(_(0,"div",10)(1,"kbd",17),r(2),h(),_(3,"span",18),r(4),h()()),o&2){let e=t.$implicit;l(2),w(e.key),l(2),w(e.value)}}function Nt(o,t){if(o&1&&r(0),o&2){let e=d();D(" Selected note: ",e.getNoteDisplayName(t)," ")}}function Et(o,t){o&1&&r(0," No note selected ")}function St(o,t){o&1&&(_(0,"div",12)(1,"div",19)(2,"span",20),r(3,"\u23F8\uFE0F"),h(),_(4,"span",21),r(5,"Input disabled"),h()()())}var ne=class o{availableNotes=I(["C","D","E","F","G","A","B"]);disabled=I(!1);showAccidentals=I(!1);selectedNote=I(null);noteSelected=Re();hoveredNote=g(null);pressedNote=g(null);noteButtons=O(()=>{let t=this.availableNotes(),e=[];return t.forEach(n=>{e.push({note:n,label:n,class:"natural-note"})}),this.showAccidentals()&&t.forEach(n=>{n!=="E"&&n!=="B"&&e.push({note:`${n}#`,label:`${n}\u266F`,class:"sharp-note"}),n!=="F"&&n!=="C"&&e.push({note:`${n}b`,label:`${n}\u266D`,class:"flat-note"})}),e.sort((n,i)=>{let s=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],u=s.indexOf(n.note),p=s.indexOf(i.note);return u-p})});keyboardShortcuts=O(()=>{let t={};return this.availableNotes().forEach((n,i)=>{let s=(i+1).toString();t[s]=n}),t});ngOnInit(){}ngOnDestroy(){}handleKeyboardEvent(t){t.key>="1"&&t.key<="7"&&(t.preventDefault(),this.onKeyboardShortcut(t.key))}onNoteClick(t){this.disabled()||(this.pressedNote.set(t),this.noteSelected.emit(t),setTimeout(()=>{this.pressedNote.set(null)},150))}onNoteHover(t){this.disabled()||this.hoveredNote.set(t)}getNoteButtonClasses(t){let e=["note-button"];return t.includes("#")?e.push("sharp"):t.includes("b")?e.push("flat"):e.push("natural"),this.disabled()&&e.push("disabled"),this.selectedNote()===t&&e.push("selected"),this.hoveredNote()===t&&e.push("hovered"),this.pressedNote()===t&&e.push("pressed"),e}getKeyboardShortcut(t){let e=this.keyboardShortcuts();return Object.keys(e).find(i=>e[i]===t)||null}isNoteSelected(t){return this.selectedNote()===t}getAriaLabel(t){let e=`Select note ${t}`;t.includes("#")?e=e.replace("#"," sharp"):t.includes("b")&&(e=e.replace("b"," flat"));let n=this.getKeyboardShortcut(t);return n&&(e+=`, keyboard shortcut ${n}`),this.isNoteSelected(t)&&(e+=", currently selected"),e}onKeyboardShortcut(t){let n=this.keyboardShortcuts()[t];n&&!this.disabled()&&this.onNoteClick(n)}getNoteDisplayName(t){return t.replace("#","\u266F").replace("b","\u266D")}getNoteColor(t){let e={C:"#e74c3c",D:"#f39c12",E:"#f1c40f",F:"#2ecc71",G:"#3498db",A:"#9b59b6",B:"#e91e63"},n=t.charAt(0);return e[n]||"#95a5a6"}playNoteSound(t){console.log(`Playing note: ${t}`)}provideHapticFeedback(){"vibrate"in navigator&&navigator.vibrate(50)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-note-input"]],hostBindings:function(e,n){e&1&&N("keydown",function(s){return n.handleKeyboardEvent(s)},be)},inputs:{availableNotes:[1,"availableNotes"],disabled:[1,"disabled"],showAccidentals:[1,"showAccidentals"],selectedNote:[1,"selectedNote"]},outputs:{noteSelected:"noteSelected"},decls:21,vars:9,consts:[[1,"note-input-container"],[1,"input-header"],[1,"input-title"],["role","group",1,"note-buttons-grid"],["type","button",3,"class","disabled","--note-color"],[1,"input-instructions"],["role","region",1,"keyboard-help"],[1,"help-details"],[1,"help-summary"],[1,"shortcuts-list"],[1,"shortcut-item"],["role","status","aria-live","polite",1,"sr-only"],["aria-hidden","true",1,"disabled-overlay"],["type","button",3,"click","mouseenter","mouseleave","focus","blur","disabled"],[1,"note-label"],["aria-hidden","true",1,"keyboard-shortcut"],["aria-hidden","true",1,"selected-indicator"],[1,"shortcut-key"],[1,"shortcut-note"],[1,"disabled-message"],[1,"disabled-icon"],[1,"disabled-text"]],template:function(e,n){if(e&1&&(_(0,"div",0)(1,"div",1)(2,"h3",2),r(3,"Select the Note"),h()(),_(4,"div",3),F(5,wt,5,10,"button",4,xt),h(),_(7,"p",5),r(8,"Click a button or use keyboard shortcuts (1-7)"),h(),_(9,"div",6)(10,"details",7)(11,"summary",8),r(12,"Keyboard Shortcuts"),h(),_(13,"div",9),F(14,Ot,5,2,"div",10,yt),Ie(16,"keyvalue"),h()()(),_(17,"div",11),b(18,Nt,1,1)(19,Et,1,0),h(),b(20,St,6,0,"div",12),h()),e&2){let i;m("aria-label","Note selection interface"),l(4),G("single-note-button-grid",n.noteButtons().length===1),m("aria-label","Note selection buttons"),l(),R(n.noteButtons()),l(4),m("aria-label","Keyboard shortcuts"),l(5),R(Fe(16,7,n.keyboardShortcuts())),l(4),C((i=n.selectedNote())?18:19,i),l(2),C(n.disabled()?20:-1)}},dependencies:[j,Be],styles:['.note-input-container[_ngcontent-%COMP%]{position:relative;padding:0;background:transparent;border-radius:0;box-shadow:none;margin:0}.note-input-container[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.note-input-container[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]   .input-title[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;color:var(--electric-mint);margin:0 0 8px;font-family:Courier New,Courier,monospace}.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(2,auto);gap:2px;margin-bottom:20px;max-width:600px;margin-left:auto;margin-right:auto;background:#6393;border:1px solid rgba(102,51,153,.3)}.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid.single-note-button-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.note-input-container[_ngcontent-%COMP%]   .input-instructions[_ngcontent-%COMP%]{font-size:.85rem;color:#e8ccff80;margin:0;font-style:italic;letter-spacing:.1em;font-family:Courier New,Courier,monospace;text-align:center}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px 12px;border:none;border-radius:0;background:var(--violet-mid);color:var(--pale-lavender);font-family:Courier New,Courier,monospace;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:none;min-height:90px;overflow:hidden}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:3px;height:0;background:var(--fuchsia);transition:height .4s ease}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){background:var(--violet-surface);transform:none;box-shadow:none}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled):before{height:100%}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled)   .note-label[_ngcontent-%COMP%]{color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:focus{outline:2px solid var(--fuchsia);outline-offset:-2px;z-index:10}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:active:not(.disabled), .note-input-container[_ngcontent-%COMP%]   .note-button.pressed[_ngcontent-%COMP%]{background:#ff00aa1a;transform:none}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]{background:#ff00aa26;color:var(--white);border:none;box-shadow:inset 0 0 20px #ff00aa4d}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]:before{height:100%;width:4px}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:var(--fuchsia);text-shadow:0 0 10px rgba(255,0,170,.8)}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]   .keyboard-shortcut[_ngcontent-%COMP%]{background:#f0a3;color:var(--fuchsia);border-color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button.hovered[_ngcontent-%COMP%]:not(.disabled):not(.selected){background:var(--violet-surface)}.note-input-container[_ngcontent-%COMP%]   .note-button.disabled[_ngcontent-%COMP%]{opacity:.3;cursor:not-allowed;transform:none!important}.note-input-container[_ngcontent-%COMP%]   .note-button.disabled[_ngcontent-%COMP%]:before{display:none}.note-input-container[_ngcontent-%COMP%]   .note-button.natural[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:var(--pale-lavender)}.note-input-container[_ngcontent-%COMP%]   .note-button.sharp[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:#8e44ad}.note-input-container[_ngcontent-%COMP%]   .note-button.sharp.selected[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:#8e44ad;text-shadow:0 0 10px rgba(142,68,173,.8)}.note-input-container[_ngcontent-%COMP%]   .note-button.sharp[_ngcontent-%COMP%]:hover:not(.disabled)   .note-label[_ngcontent-%COMP%]{color:#8e44ad}.note-input-container[_ngcontent-%COMP%]   .note-button.flat[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:#16a085}.note-input-container[_ngcontent-%COMP%]   .note-button.flat.selected[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{color:#16a085;text-shadow:0 0 10px rgba(22,160,133,.8)}.note-input-container[_ngcontent-%COMP%]   .note-button.flat[_ngcontent-%COMP%]:hover:not(.disabled)   .note-label[_ngcontent-%COMP%]{color:#16a085}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{font-size:24px;font-weight:900;margin-bottom:6px;transition:all .3s ease;letter-spacing:.05em}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .keyboard-shortcut[_ngcontent-%COMP%]{font-size:.75rem;background:#6633994d;color:#e8ccff99;padding:3px 8px;border-radius:0;border:1px solid rgba(102,51,153,.4);font-weight:700;transition:all .3s ease;clip-path:polygon(3px 0,100% 0,calc(100% - 3px) 100%,0 100%);letter-spacing:.1em}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .selected-indicator[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;font-size:16px;color:var(--fuchsia);animation:_ngcontent-%COMP%_checkmark .3s ease;text-shadow:0 0 8px rgba(255,0,170,.8)}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]{margin-top:24px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]{background:#0d002099;border:1px solid rgba(102,51,153,.3);border-radius:0;overflow:hidden}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]{padding:12px 16px;background:#1a0035cc;cursor:pointer;font-weight:700;font-size:.8rem;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint);border:none;outline:none;transition:background-color .3s ease;font-family:Courier New,Courier,monospace}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]:hover{background:#220044e6}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .help-summary[_ngcontent-%COMP%]:focus{background:#220044e6;box-shadow:inset 0 0 0 2px var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcuts-list[_ngcontent-%COMP%]{padding:16px;display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 0}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]   .shortcut-key[_ngcontent-%COMP%]{background:var(--fuchsia);color:var(--violet-dark);padding:4px 10px;border-radius:0;font-size:.85rem;font-weight:900;min-width:28px;text-align:center;font-family:Courier New,Courier,monospace;clip-path:polygon(3px 0,100% 0,calc(100% - 3px) 100%,0 100%);letter-spacing:.05em}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .help-details[_ngcontent-%COMP%]   .shortcut-item[_ngcontent-%COMP%]   .shortcut-note[_ngcontent-%COMP%]{font-weight:700;font-size:.85rem;color:var(--pale-lavender);font-family:Courier New,Courier,monospace}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0d0020e6;display:flex;align-items:center;justify-content:center;border-radius:0;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:100}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:24px 32px;background:var(--violet-surface);border-radius:0;border:1px solid var(--rebecca);box-shadow:0 0 30px #f0a3;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%)}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]   .disabled-icon[_ngcontent-%COMP%]{font-size:32px}.note-input-container[_ngcontent-%COMP%]   .disabled-overlay[_ngcontent-%COMP%]   .disabled-message[_ngcontent-%COMP%]   .disabled-text[_ngcontent-%COMP%]{font-weight:700;font-size:.8rem;letter-spacing:.1em;text-transform:uppercase;color:#e8ccff99;font-family:Courier New,Courier,monospace}@keyframes _ngcontent-%COMP%_checkmark{0%{transform:scale(0);opacity:0}50%{transform:scale(1.3)}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.note-input-container[_ngcontent-%COMP%]   .note-buttons-grid[_ngcontent-%COMP%]{gap:2px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{padding:16px 8px;min-height:80px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{font-size:20px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .keyboard-shortcut[_ngcontent-%COMP%]{padding:2px 6px}.note-input-container[_ngcontent-%COMP%]   .keyboard-help[_ngcontent-%COMP%]   .shortcuts-list[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}}@media (max-width: 480px){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{min-height:70px;padding:12px 6px}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]   .note-label[_ngcontent-%COMP%]{font-size:18px}}@media (prefers-contrast: high){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{border:2px solid var(--white)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){border-color:var(--fuchsia)}.note-input-container[_ngcontent-%COMP%]   .note-button.selected[_ngcontent-%COMP%]{background:var(--fuchsia);color:var(--white);border-color:var(--fuchsia)}}@media (prefers-reduced-motion: reduce){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{transition:none}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:before{transition:none}.note-input-container[_ngcontent-%COMP%]   .selected-indicator[_ngcontent-%COMP%]{animation:none}}@media (prefers-color-scheme: dark){.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]{background:var(--violet-mid);color:var(--pale-lavender)}.note-input-container[_ngcontent-%COMP%]   .note-button[_ngcontent-%COMP%]:hover:not(.disabled){background:var(--violet-surface)}}.note-input-container[_ngcontent-%COMP%]:focus-within   .note-button[_ngcontent-%COMP%]:focus{z-index:10}']})};var At=["nextNoteButton"],kt=(o,t)=>t.mode,Ze=(o,t)=>t.filter;function Dt(o,t){if(o&1){let e=k();c(0,"li")(1,"button",45),N("click",function(){let i=M(e).$implicit,s=d(3);return P(s.selectDifficulty(i.mode))}),c(2,"span",46),r(3),a(),c(4,"span",47),r(5),a()()()}if(o&2){let e=t.$implicit,n=d(3);l(),G("active",n.difficultyMode()===e.mode),m("aria-label",e.label+": "+e.description),l(2),w(e.label),l(2),w(e.description)}}function Tt(o,t){if(o&1){let e=k();c(0,"ul",44),N("keydown",function(i){M(e);let s=d(2);return P(s.onMenuKeydown(i))}),F(1,Dt,6,5,"li",null,kt),a()}if(o&2){let e=d(2);U("cdkTrapFocus",!0),l(),R(e.difficultyModes)}}function It(o,t){if(o&1){let e=k();c(0,"button",45),N("click",function(){let i=M(e).$implicit,s=d(3);return P(s.selectClef(i.filter))}),c(1,"span",46),r(2),a(),c(3,"span",47),r(4),a()()}if(o&2){let e=t.$implicit,n=t.$index,i=d(3);G("active",i.clefFilter()===e.filter),m("aria-label",e.label+": "+e.description)("autofocus",n===0?!0:null),l(2),w(e.label),l(2),w(e.description)}}function Ft(o,t){if(o&1){let e=k();c(0,"div",48),N("keydown",function(i){M(e);let s=d(2);return P(s.onMenuKeydown(i))}),F(1,It,5,6,"button",49,Ze),a()}if(o&2){let e=d(2);l(),R(e.clefFilters)}}function Rt(o,t){if(o&1){let e=k();c(0,"button",45),N("click",function(){let i=M(e).$implicit,s=d(3);return P(s.selectNote(i.filter))}),c(1,"span",46),r(2),a(),c(3,"span",47),r(4),a()()}if(o&2){let e=t.$implicit,n=t.$index,i=d(3);G("active",i.noteFilter()===e.filter),m("aria-label",e.label+": "+e.description)("autofocus",n===0?!0:null),l(2),w(e.label),l(2),w(e.description)}}function Lt(o,t){if(o&1){let e=k();c(0,"div",48),N("keydown",function(i){M(e);let s=d(2);return P(s.onMenuKeydown(i))}),F(1,Rt,5,6,"button",49,Ze),a()}if(o&2){let e=d(2);l(),R(e.noteFilters)}}function Bt(o,t){if(o&1){let e=k();c(0,"div",7)(1,"div",32)(2,"div",33)(3,"span",34),r(4,"Level"),a(),c(5,"div",35)(6,"button",36),N("click",function(){M(e);let i=d();return P(i.toggleDifficultyDropdown())}),r(7),c(8,"span",37),r(9,"\u25BC"),a()(),b(10,Tt,3,1,"ul",38),a()(),c(11,"div",33)(12,"span",34),r(13,"Clef"),a(),c(14,"div",35)(15,"button",36),N("click",function(){M(e);let i=d();return P(i.toggleClefDropdown())}),r(16),c(17,"span",37),r(18,"\u25BC"),a()(),b(19,Ft,3,0,"div",39),a()(),c(20,"div",33)(21,"span",34),r(22,"Note"),a(),c(23,"div",35)(24,"button",36),N("click",function(){M(e);let i=d();return P(i.toggleNoteDropdown())}),r(25),c(26,"span",37),r(27,"\u25BC"),a()(),b(28,Lt,3,0,"div",39),a()()(),c(29,"div",40)(30,"div",41)(31,"span",34),r(32,"Overall Accuracy:"),a(),c(33,"span",42),r(34),a()(),c(35,"div",41)(36,"span",34),r(37,"Question Number:"),a(),c(38,"span",43),r(39),a()()()()}if(o&2){let e=d();l(6),m("aria-expanded",e.showDifficultyDropdown())("aria-label","Select difficulty mode. Current: "+e.getCurrentDifficultyLabel()),l(),D(" ",e.getCurrentDifficultyLabel()," "),l(3),C(e.showDifficultyDropdown()?10:-1),l(5),m("aria-expanded",e.showClefDropdown())("aria-label","Select clef filter. Current: "+e.getCurrentClefLabel()),l(),D(" ",e.getCurrentClefLabel()," "),l(3),C(e.showClefDropdown()?19:-1),l(5),m("aria-expanded",e.showNoteDropdown())("aria-label","Select note filter. Current: "+e.getCurrentNoteLabel()),l(),D(" ",e.getCurrentNoteLabel()," "),l(3),C(e.showNoteDropdown()?28:-1),l(5),G("high-accuracy",e.accuracyPercentage()>=80),l(),D(" ",e.accuracyPercentage(),"% "),l(5),w(t.totalQuestionsAnswered)}}function Ht(o,t){if(o&1&&re(0,"app-musical-staff",11),o&2){let e,n=t,i=d();U("currentNote",n)("clef",n.clef)("showNote",!0)("showResult",((e=i.feedback())==null?null:e.type)==="correct"),m("aria-label","Musical staff displaying a note to identify")}}function Vt(o,t){o&1&&(c(0,"div",12)(1,"p"),r(2,"Loading musical note..."),a()())}function $t(o,t){if(o&1){let e=k();c(0,"div",15)(1,"p",50),r(2,"What note is displayed on the staff?"),a(),c(3,"app-note-input",51),N("noteSelected",function(i){M(e);let s=d();return P(s.handleAnswer(i))}),a()()}if(o&2){let e=d();l(3),U("availableNotes",e.filteredAvailableNotes())("disabled",e.isProcessing()),m("aria-label","Select the note you think is displayed")}}function Gt(o,t){o&1&&(c(0,"div",16),re(1,"div",52),c(2,"p"),r(3,"Processing your answer..."),a()())}function Wt(o,t){o&1&&r(0," Next Note ")}function jt(o,t){o&1&&r(0," New Note ")}function zt(o,t){if(o&1){let e=k();c(0,"button",22),N("click",function(){M(e);let i=d();return P(i.showAnswer())}),r(1),a()}if(o&2){let e=d();m("aria-label","Reveal the correct answer for this note"),l(),D(" ",e.showAnswerHint()?"Hide Answer Hint":"Show Answer Hint"," ")}}function Kt(o,t){if(o&1&&(c(0,"div",55)(1,"span",58),r(2,"\u2713"),a(),c(3,"span",59),r(4),a()()),o&2){let e=d();l(4),w(e.message)}}function Ut(o,t){if(o&1&&(c(0,"div",56)(1,"span",58),r(2,"\u2717"),a(),c(3,"span",59),r(4),a()()),o&2){let e=d();l(4),w(e.message)}}function Yt(o,t){if(o&1&&(c(0,"div",57)(1,"span",58),r(2,"\u{1F4A1}"),a(),c(3,"span",59),r(4),a()()),o&2){let e=d();l(4),w(e.message)}}function qt(o,t){if(o&1&&(c(0,"section",23)(1,"h2",53),r(2,"Answer Feedback"),a(),c(3,"div",54),b(4,Kt,5,1,"div",55)(5,Ut,5,1,"div",56)(6,Yt,5,1,"div",57),a()()),o&2){let e;l(4),C((e=t.type)==="correct"?4:e==="incorrect"?5:e==="hint"?6:-1)}}function Qt(o,t){if(o&1&&(c(0,"span"),r(1),a()),o&2){let e=t;l(),De("Current note: ",e.name," ",e.octave," in ",e.clef," clef")}}var Qe=class o{constructor(t){this.renderer=t}nextNoteButton;currentNote=g(null);userProgress=g(null);feedback=g(null);isProcessing=g(!1);hasAnswered=g(!1);sessionStartTime=g(new Date);questionStartTime=g(new Date);showAnswerHint=g(!1);difficultyMode=g("default");showDifficultyDropdown=g(!1);difficultyModes=Ke;clefFilter=g("both");showClefDropdown=g(!1);clefFilters=Ue;noteFilter=g("all");showNoteDropdown=g(!1);noteFilters=Ye;pendingAnswer=g(null);showAnswerInput=O(()=>this.currentNote()&&!this.hasAnswered());canGenerateNew=O(()=>!this.isProcessing());accuracyPercentage=O(()=>{let t=this.userProgress();return t?Math.round(t.overallAccuracy*100):0});availableNotes=["C","D","E","F","G","A","B"];noteGenerator=v(ee);progressService=v(K);ngOnInit(){this.loadUserProgress(),this.generateNewNote()}ngOnDestroy(){this.saveProgress()}onDocumentClick(t){t.target.closest(".difficulty-dropdown")||(this.showDifficultyDropdown()&&(this.enableBackground(),this.showDifficultyDropdown.set(!1)),this.showClefDropdown()&&(this.enableBackground(),this.showClefDropdown.set(!1)),this.showNoteDropdown()&&(this.enableBackground(),this.showNoteDropdown.set(!1)))}onEscapeKey(){this.showDifficultyDropdown()&&(this.enableBackground(),this.showDifficultyDropdown.set(!1)),this.showClefDropdown()&&(this.enableBackground(),this.showClefDropdown.set(!1)),this.showNoteDropdown()&&(this.enableBackground(),this.showNoteDropdown.set(!1))}onMenuKeydown(t){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault()}enableBackground(){this.renderer.removeClass(document.body,"no-scroll")}disableBackground(){this.renderer.addClass(document.body,"no-scroll")}generateNewNote(){this.showAnswerHint.set(!1);let t=this.pendingAnswer();t&&(this.noteGenerator.recordAnswer(t.note,t.userAnswer,t.isCorrect,t.responseTime),this.progressService.recordQuestionAttempt(t.isCorrect,t.responseTime),this.pendingAnswer.set(null),setTimeout(()=>this.updateProgress(),0)),this.isProcessing.set(!0),this.hasAnswered.set(!1),this.feedback.set(null),this.questionStartTime.set(new Date);try{let e=this.noteGenerator.generateNextNote();this.currentNote.set(e)}catch(e){console.error("Error generating note:",e),this.feedback.set({type:"incorrect",message:"Error generating note. Please try again."})}finally{this.isProcessing.set(!1)}}handleAnswer(t){let e=this.currentNote();if(!e||this.hasAnswered())return;let n=this.validateAnswer(t,e),i=this.calculateResponseTime();this.pendingAnswer.set({note:e,userAnswer:t,isCorrect:n,responseTime:i}),this.showFeedback(n,e,t),this.hasAnswered.set(!0),setTimeout(()=>{this.nextNoteButton?.nativeElement.focus()},100)}showAnswer(){let t=this.currentNote();if(this.showAnswerHint())this.feedback.set(null);else if(t){let e=`${t.name}${t.accidental?t.accidental==="sharp"?"#":"\u266D":""}`;this.feedback.set({type:"hint",message:`The correct answer is ${e}`})}this.showAnswerHint.set(!this.showAnswerHint())}resetProgress(){confirm("Are you sure you want to reset all progress? This cannot be undone.")&&(this.noteGenerator.resetProgress(),this.progressService.resetProgress(),this.loadUserProgress(),this.generateNewNote(),this.feedback.set({type:"hint",message:"Progress has been reset. Starting over!"}))}filteredAvailableNotes=O(()=>{let t=this.noteFilter();return t==="all"?this.availableNotes:[t]});toggleDifficultyDropdown(){this.showDifficultyDropdown.update(t=>!t),this.showDifficultyDropdown()&&(this.showClefDropdown.set(!1),this.showNoteDropdown.set(!1),this.disableBackground())}selectDifficulty(t){this.difficultyMode.set(t),this.showDifficultyDropdown.set(!1),this.noteGenerator.setDifficultyMode(t),this.generateNewNote()}getCurrentDifficultyLabel(){return this.difficultyModes.find(e=>e.mode===this.difficultyMode())?.label||"Default"}toggleClefDropdown(){this.showClefDropdown.update(t=>!t),this.showClefDropdown()&&(this.showDifficultyDropdown.set(!1),this.showNoteDropdown.set(!1),this.disableBackground())}selectClef(t){this.clefFilter.set(t),this.showClefDropdown.set(!1),this.noteGenerator.setClefFilter(t),this.generateNewNote()}getCurrentClefLabel(){return this.clefFilters.find(e=>e.filter===this.clefFilter())?.label||"Both"}toggleNoteDropdown(){this.showNoteDropdown.update(t=>!t),this.showNoteDropdown()&&(this.showDifficultyDropdown.set(!1),this.showClefDropdown.set(!1),this.disableBackground())}selectNote(t){this.noteFilter.set(t),this.showNoteDropdown.set(!1),this.noteGenerator.setNoteFilter(t),this.generateNewNote()}getCurrentNoteLabel(){return this.noteFilters.find(e=>e.filter===this.noteFilter())?.label||"All"}validateAnswer(t,e){return t.replace(/[#b]/g,"").toUpperCase()===e.name}calculateResponseTime(){let t=this.questionStartTime();return new Date().getTime()-t.getTime()}showFeedback(t,e,n){if(t){let i=["Excellent! \u{1F3B5}","Perfect! \u{1F3B6}","Great job! \u2728","Correct! \u{1F3AF}","Well done! \u{1F44F}"],s=i[Math.floor(Math.random()*i.length)];this.feedback.set({type:"correct",message:s})}else{let i=`${e.name}${e.accidental?e.accidental==="sharp"?"#":"\u266D":""}`;this.feedback.set({type:"incorrect",message:`Not quite. You answered "${n}", but the correct answer is "${i}".`})}}loadUserProgress(){try{let t=this.progressService.getCurrentProgress();this.userProgress.set(t)}catch(t){console.error("Error loading user progress:",t),this.userProgress.set({currentLevel:"easy",totalQuestionsAnswered:0,overallAccuracy:0,sessionStartTime:new Date,levelProgression:[]})}}updateProgress(){try{let t=this.progressService.getCurrentProgress();this.userProgress.set(t)}catch(t){console.error("Error updating progress:",t)}}saveProgress(){try{this.progressService.saveProgress()}catch(t){console.error("Error saving progress:",t)}}static \u0275fac=function(e){return new(e||o)(ye(xe))};static \u0275cmp=V({type:o,selectors:[["app-note-tutor"]],viewQuery:function(e,n){if(e&1&&Ee(At,5),e&2){let i;Se(i=Ae())&&(n.nextNoteButton=i.first)}},hostBindings:function(e,n){e&1&&N("click",function(s){return n.onDocumentClick(s)},ie)("keydown.escape",function(){return n.onEscapeKey()},ie)},decls:130,vars:10,consts:[["nextNoteButton",""],[1,"note-tutor-container"],[1,"game-header"],[1,"line-1"],[1,"line-2"],["aria-labelledby","progress-heading",1,"progress-section"],["id","progress-heading",1,"sr-only"],[1,"stats-grid"],["role","main",1,"game-area"],["aria-labelledby","staff-heading",1,"staff-section"],["id","staff-heading",1,"sr-only"],[1,"staff-container",3,"currentNote","clef","showNote","showResult"],["role","status","aria-live","polite",1,"staff-placeholder"],["aria-labelledby","input-heading",1,"input-section"],["id","input-heading",1,"sr-only"],[1,"input-container"],["role","status","aria-live","polite",1,"processing-state"],["aria-labelledby","controls-heading",1,"controls-section"],["id","controls-heading",1,"sr-only"],[1,"controls"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","button",1,"btn","btn-secondary"],["type","button",1,"btn","btn-secondary",3,"click"],["aria-labelledby","feedback-heading",1,"feedback-section"],["aria-labelledby","instructions-heading",1,"instructions-panel"],["id","instructions-heading"],[1,"instructions-content"],[1,"instructions-list"],[1,"instruction-header"],[1,"tips-section"],[1,"tips-list"],["aria-live","polite","id","screen-reader-announcements",1,"sr-only"],[1,"stat-line","options-stat-line"],[1,"stat-item","difficulty-selector"],[1,"stat-label"],[1,"difficulty-dropdown"],["type","button",1,"stat-value","level-badge","difficulty-button",3,"click"],[1,"dropdown-arrow"],["role","menu",1,"difficulty-menu",3,"cdkTrapFocus"],["role","menu","tabindex","-1",1,"difficulty-menu"],[1,"stat-line"],[1,"stat-item"],[1,"stat-value","accuracy-display"],[1,"stat-value"],["role","menu",1,"difficulty-menu",3,"keydown","cdkTrapFocus"],["type","button","role","menuitem",1,"difficulty-option",3,"click"],[1,"option-label"],[1,"option-description"],["role","menu","tabindex","-1",1,"difficulty-menu",3,"keydown"],["type","button","role","menuitem",1,"difficulty-option",3,"active"],[1,"instruction-text"],[1,"answer-input",3,"noteSelected","availableNotes","disabled"],["aria-hidden","true",1,"loading-spinner"],["id","feedback-heading",1,"sr-only"],[1,"feedback-container"],["role","alert","aria-live","assertive",1,"feedback","success"],["role","alert","aria-live","assertive",1,"feedback","error"],["role","status","aria-live","polite",1,"feedback","hint"],["aria-hidden","true",1,"feedback-icon"],[1,"feedback-message"]],template:function(e,n){if(e&1){let i=k();c(0,"div",1)(1,"header",2)(2,"h1")(3,"span",3),r(4,"NOTE AND SEEK"),a(),c(5,"span")(6,"span",4),r(7,"THE MUSIC NOTE TUTOR"),a()()()(),c(8,"section",5)(9,"h2",6),r(10,"Your Progress"),a(),b(11,Bt,40,16,"div",7),a(),c(12,"main",8)(13,"section",9)(14,"h2",10),r(15,"Musical Staff"),a(),b(16,Ht,1,5,"app-musical-staff",11)(17,Vt,3,0,"div",12),a(),c(18,"section",13)(19,"h2",14),r(20,"Answer Input"),a(),b(21,$t,4,3,"div",15)(22,Gt,4,0,"div",16),a(),c(23,"section",17)(24,"h2",18),r(25,"Game Controls"),a(),c(26,"div",19)(27,"button",20,0),N("click",function(){return M(i),P(n.generateNewNote())}),b(29,Wt,1,0)(30,jt,1,0),a(),b(31,zt,2,2,"button",21),c(32,"button",22),N("click",function(){return M(i),P(n.resetProgress())}),r(33," Reset Progress "),a()()(),b(34,qt,7,1,"section",23),a(),c(35,"aside",24)(36,"h2",25),r(37,"How to Play"),a(),c(38,"div",26)(39,"ol",27)(40,"li",28),r(41,"Choose your "),c(42,"strong"),r(43,"Difficulty"),a(),r(44," level: "),c(45,"ul")(46,"li")(47,"strong"),r(48,"Default:"),a(),r(49," All note positions (staff + ledger lines)"),a(),c(50,"li")(51,"strong"),r(52,"Easy:"),a(),r(53," Only notes on the staff lines and spaces"),a(),c(54,"li")(55,"strong"),r(56,"Hard:"),a(),r(57," Only notes on ledger lines above and below staff"),a()()(),c(58,"li",28),r(59,"Select your "),c(60,"strong"),r(61,"Clef"),a(),r(62," preference: "),c(63,"ul")(64,"li")(65,"strong"),r(66,"Both:"),a(),r(67," Practice treble and bass clef notes"),a(),c(68,"li")(69,"strong"),r(70,"Treble:"),a(),r(71," Focus on treble clef only"),a(),c(72,"li")(73,"strong"),r(74,"Bass:"),a(),r(75," Focus on bass clef only"),a()()(),c(76,"li",28),r(77,"Choose a "),c(78,"strong"),r(79,"Note"),a(),r(80," to practice: "),c(81,"ul")(82,"li")(83,"strong"),r(84,"All:"),a(),r(85," Practice all notes (C through B)"),a(),c(86,"li")(87,"strong"),r(88,"C, D, E, F, G, A, or B:"),a(),r(89," Focus on a single note for targeted practice"),a()()(),c(90,"li"),r(91,"Look at the note displayed on the musical staff"),a(),c(92,"li"),r(93,"Identify which note it represents"),a(),c(94,"li"),r(95,"Click on your answer from the available options"),a(),c(96,"li"),r(97,"Get instant feedback and track your progress"),a()(),c(98,"div",29)(99,"h3"),r(100,"Tips for Success:"),a(),c(101,"ul",30)(102,"li"),r(103,"Start with "),c(104,"strong"),r(105,"Easy"),a(),r(106," difficulty and a single "),c(107,"strong"),r(108,"Note"),a(),r(109," to build confidence"),a(),c(110,"li"),r(111,'Use mnemonics like "Every Good Boy Does Fine" for treble clef lines'),a(),c(112,"li"),r(113,"Practice one clef and one note at a time before combining"),a(),c(114,"li"),r(115,"Once comfortable with individual notes, switch to "),c(116,"strong"),r(117,"All"),a(),r(118," notes for full practice"),a(),c(119,"li"),r(120,"Progress to "),c(121,"strong"),r(122,"Hard"),a(),r(123," difficulty to master ledger lines"),a(),c(124,"li"),r(125,"Practice regularly to build muscle memory"),a(),c(126,"li"),r(127,"Don't worry about mistakes - they help you learn!"),a()()()()(),c(128,"div",31),b(129,Qt,2,3,"span"),a()()}if(e&2){let i,s,u,p;l(11),C((i=n.userProgress())?11:-1,i),l(5),C((s=n.currentNote())?16:17,s),l(5),C(n.showAnswerInput()?21:n.isProcessing()?22:-1),l(6),U("disabled",!n.canGenerateNew()),m("aria-label",n.hasAnswered()?"Generate next musical note":"Generate new musical note"),l(2),C(n.hasAnswered()?29:30),l(2),C(n.showAnswerInput()?31:-1),l(),m("aria-label","Reset all progress"),l(2),C((u=n.feedback())?34:-1,u),l(95),C((p=n.currentNote())?129:-1,p)}},dependencies:[j,te,ne,de],styles:['.note-tutor-container[_ngcontent-%COMP%]{min-height:100vh;display:grid;grid-template-areas:"header header" "progress progress" "main instructions" "main instructions";grid-template-columns:1fr 350px;grid-template-rows:auto auto 1fr auto;gap:2px;padding:0;background:var(--violet-dark);font-family:Courier New,Courier,monospace;position:relative}@media (max-width: 1024px){.note-tutor-container[_ngcontent-%COMP%]{grid-template-areas:"header" "progress" "main" "instructions";grid-template-columns:1fr;grid-template-rows:auto auto 1fr auto}}.game-header[_ngcontent-%COMP%]{grid-area:header;display:flex;justify-content:space-between;align-items:center;padding:24px 40px;background:#0d0020d9;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid var(--rebecca)}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-family:Courier New,Courier,monospace;font-size:1.8rem;font-weight:900;line-height:.9;letter-spacing:-.02em;display:flex;flex-direction:column;align-items:flex-start}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .line-1[_ngcontent-%COMP%]{color:var(--white)}.game-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .line-2[_ngcontent-%COMP%]{color:var(--fuchsia);text-shadow:0 0 60px rgba(255,0,170,.8),0 0 120px rgba(255,0,170,.4);animation:flicker 4s ease-in-out infinite}.progress-section[_ngcontent-%COMP%]{grid-area:progress;background:var(--violet-surface);border-top:1px solid rgba(102,51,153,.4);border-bottom:1px solid rgba(102,51,153,.4);padding:24px 40px}.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:20px}.progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{display:inline-flex;gap:80px;justify-content:center}.progress-section[_ngcontent-%COMP%]   .options-stat-line[_ngcontent-%COMP%]{gap:40px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.9rem;letter-spacing:.2em;text-transform:uppercase;color:var(--pale-lavender);margin-bottom:4px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:2.5rem;font-weight:900;color:var(--fuchsia);text-shadow:0 0 20px rgba(255,0,170,.6);line-height:1}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.level-badge[_ngcontent-%COMP%]{font-size:1rem;padding:6px 14px;border:1px solid var(--fuchsia);clip-path:polygon(6px 0,100% 0,calc(100% - 6px) 100%,0 100%);text-transform:capitalize;text-shadow:none}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.accuracy-display[_ngcontent-%COMP%]{color:var(--electric-mint);text-shadow:0 0 20px rgba(0,255,204,.6)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.accuracy-display.high-accuracy[_ngcontent-%COMP%]{animation:flicker 4s ease-in-out infinite}.progress-section[_ngcontent-%COMP%]   .stat-item.difficulty-selector[_ngcontent-%COMP%], .progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-dropdown[_ngcontent-%COMP%]{position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]{cursor:pointer;background:transparent;border:1px solid var(--fuchsia);display:flex;align-items:center;gap:8px;transition:all .3s ease}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]:hover{background:#ff00aa1a;box-shadow:0 0 20px #ff00aa4d}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{font-size:.6rem;transition:transform .3s ease}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-button[aria-expanded=true][_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{transform:rotate(180deg)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 8px);left:50%;transform:translate(-50%);background:var(--violet-surface);border:1px solid var(--fuchsia);box-shadow:0 0 20px #f0a6;z-index:1000;min-width:280px;overflow:auto;pointer-events:all}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;padding:12px 16px;background:transparent;border:none;border-bottom:1px solid rgba(102,51,153,.3);width:100%;cursor:pointer;transition:all .3s ease;text-align:left}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]:last-child{border-bottom:none}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]:hover{background:#ff00aa1a}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option.active[_ngcontent-%COMP%]{background:#ff00aa26;border-left:3px solid var(--electric-mint)}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:.95rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--fuchsia);margin-bottom:4px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-option[_ngcontent-%COMP%]   .option-description[_ngcontent-%COMP%]{font-size:.85rem;color:#e8ccff99;line-height:1.4}.game-area[_ngcontent-%COMP%]{grid-area:main;display:flex;flex-direction:column;gap:32px;padding:40px;background:var(--violet-mid);min-height:600px;position:relative;overflow:hidden}.game-area[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-image:linear-gradient(rgba(102,51,153,.1) 1px,transparent 1px),linear-gradient(90deg,rgba(102,51,153,.1) 1px,transparent 1px);background-size:40px 40px;animation:_ngcontent-%COMP%_gridScroll 15s linear infinite;pointer-events:none}@keyframes _ngcontent-%COMP%_gridScroll{0%{background-position:0 0}to{background-position:40px 40px}}.game-area[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;z-index:1}.staff-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:250px;padding:32px;background:#0d002099;border:1px solid rgba(102,51,153,.3);clip-path:polygon(12px 0,100% 0,calc(100% - 12px) 100%,0 100%)}.staff-section[_ngcontent-%COMP%]   .staff-container[_ngcontent-%COMP%]{width:100%;max-width:600px}.staff-section[_ngcontent-%COMP%]   .staff-placeholder[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;color:#e8ccff66;font-style:italic;font-size:.9rem;letter-spacing:.1em}.input-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:24px}.input-section[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;width:100%;max-width:500px}.input-section[_ngcontent-%COMP%]   .instruction-text[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint);text-align:center;margin:0}.input-section[_ngcontent-%COMP%]   .answer-input[_ngcontent-%COMP%]{width:100%}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;color:var(--pale-lavender)}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid rgba(102,51,153,.3);border-top:3px solid var(--fuchsia);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.input-section[_ngcontent-%COMP%]   .processing-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;letter-spacing:.1em;text-transform:uppercase}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.feedback-section[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0}.feedback-section[_ngcontent-%COMP%]   .feedback-container[_ngcontent-%COMP%]{width:100%;max-width:600px}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 24px;font-weight:700;font-size:.9rem;letter-spacing:.05em;animation:_ngcontent-%COMP%_fadeInUp .3s ease-out;clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%);border:1px solid}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   .feedback-icon[_ngcontent-%COMP%]{font-size:1.5rem;flex-shrink:0}.feedback-section[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   .feedback-message[_ngcontent-%COMP%]{flex:1}.feedback-section[_ngcontent-%COMP%]   .feedback.success[_ngcontent-%COMP%]{background:#00ffcc1a;color:var(--electric-mint);border-color:var(--electric-mint);box-shadow:0 0 20px #0fc3}.feedback-section[_ngcontent-%COMP%]   .feedback.success[_ngcontent-%COMP%]   .feedback-icon[_ngcontent-%COMP%]{animation:pulse 2s ease-in-out infinite}.feedback-section[_ngcontent-%COMP%]   .feedback.error[_ngcontent-%COMP%]{background:#ff00aa1a;color:var(--fuchsia);border-color:var(--fuchsia);box-shadow:0 0 20px #f0a3}.feedback-section[_ngcontent-%COMP%]   .feedback.hint[_ngcontent-%COMP%]{background:#e8ccff0d;color:var(--pale-lavender);border-color:var(--rebecca)}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.controls-section[_ngcontent-%COMP%]{display:flex;justify-content:center}.controls-section[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;justify-content:center}.instructions-panel[_ngcontent-%COMP%]{grid-area:instructions;padding:40px 32px;background:var(--violet-surface);border-left:1px solid rgba(102,51,153,.4);height:100%;overflow-y:auto}.instructions-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 24px;font-size:1.2rem;font-weight:900;letter-spacing:.05em;color:var(--white);text-transform:uppercase}.instructions-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"// ";color:var(--fuchsia)}.instructions-panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:32px 0 16px;font-size:1rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--electric-mint)}.instructions-panel[_ngcontent-%COMP%]   .instructions-content[_ngcontent-%COMP%]{color:#e8ccffb3}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]{margin:0;padding-left:24px;line-height:1.8}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.92rem;margin-bottom:12px;color:#e8ccff99}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child, .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker, .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{color:var(--rebecca)}.instructions-panel[_ngcontent-%COMP%]   .instructions-list[_ngcontent-%COMP%]   .instruction-header[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]   .tips-list[_ngcontent-%COMP%]   .instruction-header[_ngcontent-%COMP%]{font-size:1.1rem}.instructions-panel[_ngcontent-%COMP%]   .tips-section[_ngcontent-%COMP%]{margin-top:32px;padding-top:32px;border-top:1px solid rgba(102,51,153,.3)}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}@media (max-width: 1024px){.instructions-panel[_ngcontent-%COMP%]{border-left:none;border-top:1px solid rgba(102,51,153,.4)}}@media (max-width: 768px){.note-tutor-container[_ngcontent-%COMP%]{gap:0}.game-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;padding:20px;text-align:center}.progress-section[_ngcontent-%COMP%]{padding:10px}.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%], .progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{gap:40px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem}.progress-section[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{max-height:80vh}.game-area[_ngcontent-%COMP%]{padding:24px;gap:24px}.staff-section[_ngcontent-%COMP%]{padding:6px;min-height:200px}.instructions-panel[_ngcontent-%COMP%]{padding:24px 20px}}@media (max-width: 480px){.progress-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{gap:24px;grid-template-columns:1fr 1fr}.progress-section[_ngcontent-%COMP%]   .stat-line[_ngcontent-%COMP%]{gap:15px}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{position:relative}.progress-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .difficulty-menu[_ngcontent-%COMP%]{position:fixed;left:50%;top:auto;transform:translate(-50%);max-width:90vw;z-index:2000;margin-top:15px;max-height:50vh}.game-area[_ngcontent-%COMP%]{padding:12px;gap:12px}.controls[_ngcontent-%COMP%]{flex-direction:column;width:100%}.controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.feedback[_ngcontent-%COMP%]   .feedback-message[_ngcontent-%COMP%]{font-size:.75rem}}@media (prefers-contrast: high){.game-header[_ngcontent-%COMP%], .progress-section[_ngcontent-%COMP%], .game-area[_ngcontent-%COMP%], .instructions-panel[_ngcontent-%COMP%]{border:2px solid var(--white)}.feedback.success[_ngcontent-%COMP%], .feedback.error[_ngcontent-%COMP%]{border-width:2px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}.loading-spinner[_ngcontent-%COMP%]{animation:none;border-top-color:var(--fuchsia)}.game-area[_ngcontent-%COMP%]:before{animation:none}}']})};export{Qe as NoteTutor};
